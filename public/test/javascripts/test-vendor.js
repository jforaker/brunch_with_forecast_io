!function(){"use strict";var globals="undefined"!=typeof window?window:global;if("function"!=typeof globals.require){var modules={},cache={},has=function(object,name){return{}.hasOwnProperty.call(object,name)},expand=function(root,name){var parts,part,results=[];parts=/^\.\.?(\/|$)/.test(name)?[root,name].join("/").split("/"):name.split("/");for(var i=0,length=parts.length;length>i;i++)part=parts[i],".."===part?results.pop():"."!==part&&""!==part&&results.push(part);return results.join("/")},dirname=function(path){return path.split("/").slice(0,-1).join("/")},localRequire=function(path){return function(name){var dir=dirname(path),absolute=expand(dir,name);return globals.require(absolute,path)}},initModule=function(name,definition){var module={id:name,exports:{}};return cache[name]=module,definition(module.exports,localRequire(name),module),module.exports},require=function(name,loaderPath){var path=expand(name,".");if(null==loaderPath&&(loaderPath="/"),has(cache,path))return cache[path].exports;if(has(modules,path))return initModule(path,modules[path]);var dirIndex=expand(path,"./index");if(has(cache,dirIndex))return cache[dirIndex].exports;if(has(modules,dirIndex))return initModule(dirIndex,modules[dirIndex]);throw new Error('Cannot find module "'+name+'" from "'+loaderPath+'"')},define=function(bundle,fn){if("object"==typeof bundle)for(var key in bundle)has(bundle,key)&&(modules[key]=bundle[key]);else modules[bundle]=fn},list=function(){var result=[];for(var item in modules)has(modules,item)&&result.push(item);return result};globals.require=require,globals.require.define=define,globals.require.register=define,globals.require.list=list,globals.require.brunch=!0}}(),!function(name,context,definition){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?module.exports=definition():"function"==typeof define&&"object"==typeof define.amd?define(function(){return definition()}):context[name]=definition()}("chai",this,function(){function require(p){var path=require.resolve(p),mod=require.modules[path];if(!mod)throw new Error('failed to require "'+p+'"');return mod.exports||(mod.exports={},mod.call(mod.exports,mod,mod.exports,require.relative(path))),mod.exports}return require.modules={},require.resolve=function(path){var orig=path,reg=path+".js",index=path+"/index.js";return require.modules[reg]&&reg||require.modules[index]&&index||orig},require.register=function(path,fn){require.modules[path]=fn},require.relative=function(parent){return function(p){if("."!=p.charAt(0))return require(p);var path=parent.split("/"),segs=p.split("/");path.pop();for(var i=0;i<segs.length;i++){var seg=segs[i];".."==seg?path.pop():"."!=seg&&path.push(seg)}return require(path.join("/"))}},require.alias=function(from,to){var fn=require.modules[from];require.modules[to]=fn},require.register("chai.js",function(module,exports,require){var used=[],exports=module.exports={};exports.version="1.5.0",exports.Assertion=require("./chai/assertion"),exports.AssertionError=require("./chai/error");var util=require("./chai/utils");exports.use=function(fn){return~used.indexOf(fn)||(fn(this,util),used.push(fn)),this};var core=require("./chai/core/assertions");exports.use(core);var expect=require("./chai/interface/expect");exports.use(expect);var should=require("./chai/interface/should");exports.use(should);var assert=require("./chai/interface/assert");exports.use(assert)}),require.register("chai/assertion.js",function(module,exports,require){function Assertion(obj,msg,stack){flag(this,"ssfi",stack||arguments.callee),flag(this,"object",obj),flag(this,"message",msg)}var AssertionError=require("./error"),util=require("./utils"),flag=util.flag;module.exports=Assertion,Assertion.includeStack=!1,Assertion.showDiff=!0,Assertion.addProperty=function(name,fn){util.addProperty(this.prototype,name,fn)},Assertion.addMethod=function(name,fn){util.addMethod(this.prototype,name,fn)},Assertion.addChainableMethod=function(name,fn,chainingBehavior){util.addChainableMethod(this.prototype,name,fn,chainingBehavior)},Assertion.overwriteProperty=function(name,fn){util.overwriteProperty(this.prototype,name,fn)},Assertion.overwriteMethod=function(name,fn){util.overwriteMethod(this.prototype,name,fn)},Assertion.prototype.assert=function(expr,msg,negateMsg,expected,_actual,showDiff){var ok=util.test(this,arguments);if(!0!==showDiff&&(showDiff=!1),!0!==Assertion.showDiff&&(showDiff=!1),!ok){var msg=util.getMessage(this,arguments),actual=util.getActual(this,arguments);throw new AssertionError({message:msg,actual:actual,expected:expected,stackStartFunction:Assertion.includeStack?this.assert:flag(this,"ssfi"),showDiff:showDiff})}},Object.defineProperty(Assertion.prototype,"_obj",{get:function(){return flag(this,"object")},set:function(val){flag(this,"object",val)}})}),require.register("chai/core/assertions.js",function(module){module.exports=function(chai,_){function an(type,msg){msg&&flag(this,"message",msg),type=type.toLowerCase();var obj=flag(this,"object"),article=~["a","e","i","o","u"].indexOf(type.charAt(0))?"an ":"a ";this.assert(type===_.type(obj),"expected #{this} to be "+article+type,"expected #{this} not to be "+article+type)}function includeChainingBehavior(){flag(this,"contains",!0)}function include(val,msg){msg&&flag(this,"message",msg);var obj=flag(this,"object");this.assert(~obj.indexOf(val),"expected #{this} to include "+_.inspect(val),"expected #{this} to not include "+_.inspect(val))}function checkArguments(){var obj=flag(this,"object"),type=Object.prototype.toString.call(obj);this.assert("[object Arguments]"===type,"expected #{this} to be arguments but got "+type,"expected #{this} to not be arguments")}function assertEqual(val,msg){msg&&flag(this,"message",msg);var obj=flag(this,"object");return flag(this,"deep")?this.eql(val):void this.assert(val===obj,"expected #{this} to equal #{exp}","expected #{this} to not equal #{exp}",val,this._obj,!0)}function assertEql(obj,msg){msg&&flag(this,"message",msg),this.assert(_.eql(obj,flag(this,"object")),"expected #{this} to deeply equal #{exp}","expected #{this} to not deeply equal #{exp}",obj,this._obj,!0)}function assertAbove(n,msg){msg&&flag(this,"message",msg);var obj=flag(this,"object");if(flag(this,"doLength")){new Assertion(obj,msg).to.have.property("length");var len=obj.length;this.assert(len>n,"expected #{this} to have a length above #{exp} but got #{act}","expected #{this} to not have a length above #{exp}",n,len)}else this.assert(obj>n,"expected #{this} to be above "+n,"expected #{this} to be at most "+n)}function assertLeast(n,msg){msg&&flag(this,"message",msg);var obj=flag(this,"object");if(flag(this,"doLength")){new Assertion(obj,msg).to.have.property("length");var len=obj.length;this.assert(len>=n,"expected #{this} to have a length at least #{exp} but got #{act}","expected #{this} to have a length below #{exp}",n,len)}else this.assert(obj>=n,"expected #{this} to be at least "+n,"expected #{this} to be below "+n)}function assertBelow(n,msg){msg&&flag(this,"message",msg);var obj=flag(this,"object");if(flag(this,"doLength")){new Assertion(obj,msg).to.have.property("length");var len=obj.length;this.assert(n>len,"expected #{this} to have a length below #{exp} but got #{act}","expected #{this} to not have a length below #{exp}",n,len)}else this.assert(n>obj,"expected #{this} to be below "+n,"expected #{this} to be at least "+n)}function assertMost(n,msg){msg&&flag(this,"message",msg);var obj=flag(this,"object");if(flag(this,"doLength")){new Assertion(obj,msg).to.have.property("length");var len=obj.length;this.assert(n>=len,"expected #{this} to have a length at most #{exp} but got #{act}","expected #{this} to have a length above #{exp}",n,len)}else this.assert(n>=obj,"expected #{this} to be at most "+n,"expected #{this} to be above "+n)}function assertInstanceOf(constructor,msg){msg&&flag(this,"message",msg);var name=_.getName(constructor);this.assert(flag(this,"object")instanceof constructor,"expected #{this} to be an instance of "+name,"expected #{this} to not be an instance of "+name)}function assertOwnProperty(name,msg){msg&&flag(this,"message",msg);var obj=flag(this,"object");this.assert(obj.hasOwnProperty(name),"expected #{this} to have own property "+_.inspect(name),"expected #{this} to not have own property "+_.inspect(name))}function assertLengthChain(){flag(this,"doLength",!0)}function assertLength(n,msg){msg&&flag(this,"message",msg);var obj=flag(this,"object");new Assertion(obj,msg).to.have.property("length");var len=obj.length;this.assert(len==n,"expected #{this} to have a length of #{exp} but got #{act}","expected #{this} to not have a length of #{act}",n,len)}function assertKeys(keys){var str,obj=flag(this,"object"),ok=!0;if(keys=keys instanceof Array?keys:Array.prototype.slice.call(arguments),!keys.length)throw new Error("keys required");var actual=Object.keys(obj),len=keys.length;if(ok=keys.every(function(key){return~actual.indexOf(key)}),flag(this,"negate")||flag(this,"contains")||(ok=ok&&keys.length==actual.length),len>1){keys=keys.map(function(key){return _.inspect(key)});var last=keys.pop();str=keys.join(", ")+", and "+last}else str=_.inspect(keys[0]);str=(len>1?"keys ":"key ")+str,str=(flag(this,"contains")?"contain ":"have ")+str,this.assert(ok,"expected #{this} to "+str,"expected #{this} to not "+str)}function assertThrows(constructor,errMsg,msg){msg&&flag(this,"message",msg);var obj=flag(this,"object");new Assertion(obj,msg).is.a("function");var thrown=!1,desiredError=null,name=null,thrownError=null;0===arguments.length?(errMsg=null,constructor=null):constructor&&(constructor instanceof RegExp||"string"==typeof constructor)?(errMsg=constructor,constructor=null):constructor&&constructor instanceof Error?(desiredError=constructor,constructor=null,errMsg=null):"function"==typeof constructor?name=(new constructor).name:constructor=null;try{obj()}catch(err){if(desiredError)return this.assert(err===desiredError,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp}",desiredError,err),this;if(constructor&&(this.assert(err instanceof constructor,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp} but #{act} was thrown",name,err),!errMsg))return this;var message="object"===_.type(err)&&"message"in err?err.message:""+err;if(null!=message&&errMsg&&errMsg instanceof RegExp)return this.assert(errMsg.exec(message),"expected #{this} to throw error matching #{exp} but got #{act}","expected #{this} to throw error not matching #{exp}",errMsg,message),this;if(null!=message&&errMsg&&"string"==typeof errMsg)return this.assert(~message.indexOf(errMsg),"expected #{this} to throw error including #{exp} but got #{act}","expected #{this} to throw error not including #{act}",errMsg,message),this;thrown=!0,thrownError=err}var actuallyGot="",expectedThrown=null!==name?name:desiredError?"#{exp}":"an error";thrown&&(actuallyGot=" but #{act} was thrown"),this.assert(thrown===!0,"expected #{this} to throw "+expectedThrown+actuallyGot,"expected #{this} to not throw "+expectedThrown+actuallyGot,desiredError,thrownError)}var Assertion=chai.Assertion,flag=(Object.prototype.toString,_.flag);["to","be","been","is","and","have","with","that","at","of"].forEach(function(chain){Assertion.addProperty(chain,function(){return this})}),Assertion.addProperty("not",function(){flag(this,"negate",!0)}),Assertion.addProperty("deep",function(){flag(this,"deep",!0)}),Assertion.addChainableMethod("an",an),Assertion.addChainableMethod("a",an),Assertion.addChainableMethod("include",include,includeChainingBehavior),Assertion.addChainableMethod("contain",include,includeChainingBehavior),Assertion.addProperty("ok",function(){this.assert(flag(this,"object"),"expected #{this} to be truthy","expected #{this} to be falsy")}),Assertion.addProperty("true",function(){this.assert(!0===flag(this,"object"),"expected #{this} to be true","expected #{this} to be false",this.negate?!1:!0)}),Assertion.addProperty("false",function(){this.assert(!1===flag(this,"object"),"expected #{this} to be false","expected #{this} to be true",this.negate?!0:!1)}),Assertion.addProperty("null",function(){this.assert(null===flag(this,"object"),"expected #{this} to be null","expected #{this} not to be null")}),Assertion.addProperty("undefined",function(){this.assert(void 0===flag(this,"object"),"expected #{this} to be undefined","expected #{this} not to be undefined")}),Assertion.addProperty("exist",function(){this.assert(null!=flag(this,"object"),"expected #{this} to exist","expected #{this} to not exist")}),Assertion.addProperty("empty",function(){var obj=flag(this,"object"),expected=obj;Array.isArray(obj)||"string"==typeof object?expected=obj.length:"object"==typeof obj&&(expected=Object.keys(obj).length),this.assert(!expected,"expected #{this} to be empty","expected #{this} not to be empty")}),Assertion.addProperty("arguments",checkArguments),Assertion.addProperty("Arguments",checkArguments),Assertion.addMethod("equal",assertEqual),Assertion.addMethod("equals",assertEqual),Assertion.addMethod("eq",assertEqual),Assertion.addMethod("eql",assertEql),Assertion.addMethod("eqls",assertEql),Assertion.addMethod("above",assertAbove),Assertion.addMethod("gt",assertAbove),Assertion.addMethod("greaterThan",assertAbove),Assertion.addMethod("least",assertLeast),Assertion.addMethod("gte",assertLeast),Assertion.addMethod("below",assertBelow),Assertion.addMethod("lt",assertBelow),Assertion.addMethod("lessThan",assertBelow),Assertion.addMethod("most",assertMost),Assertion.addMethod("lte",assertMost),Assertion.addMethod("within",function(start,finish,msg){msg&&flag(this,"message",msg);var obj=flag(this,"object"),range=start+".."+finish;if(flag(this,"doLength")){new Assertion(obj,msg).to.have.property("length");var len=obj.length;this.assert(len>=start&&finish>=len,"expected #{this} to have a length within "+range,"expected #{this} to not have a length within "+range)}else this.assert(obj>=start&&finish>=obj,"expected #{this} to be within "+range,"expected #{this} to not be within "+range)}),Assertion.addMethod("instanceof",assertInstanceOf),Assertion.addMethod("instanceOf",assertInstanceOf),Assertion.addMethod("property",function(name,val,msg){msg&&flag(this,"message",msg);var descriptor=flag(this,"deep")?"deep property ":"property ",negate=flag(this,"negate"),obj=flag(this,"object"),value=flag(this,"deep")?_.getPathValue(name,obj):obj[name];if(negate&&void 0!==val){if(void 0===value)throw msg=null!=msg?msg+": ":"",new Error(msg+_.inspect(obj)+" has no "+descriptor+_.inspect(name))}else this.assert(void 0!==value,"expected #{this} to have a "+descriptor+_.inspect(name),"expected #{this} to not have "+descriptor+_.inspect(name));void 0!==val&&this.assert(val===value,"expected #{this} to have a "+descriptor+_.inspect(name)+" of #{exp}, but got #{act}","expected #{this} to not have a "+descriptor+_.inspect(name)+" of #{act}",val,value),flag(this,"object",value)}),Assertion.addMethod("ownProperty",assertOwnProperty),Assertion.addMethod("haveOwnProperty",assertOwnProperty),Assertion.addChainableMethod("length",assertLength,assertLengthChain),Assertion.addMethod("lengthOf",assertLength,assertLengthChain),Assertion.addMethod("match",function(re,msg){msg&&flag(this,"message",msg);var obj=flag(this,"object");this.assert(re.exec(obj),"expected #{this} to match "+re,"expected #{this} not to match "+re)}),Assertion.addMethod("string",function(str,msg){msg&&flag(this,"message",msg);var obj=flag(this,"object");new Assertion(obj,msg).is.a("string"),this.assert(~obj.indexOf(str),"expected #{this} to contain "+_.inspect(str),"expected #{this} to not contain "+_.inspect(str))}),Assertion.addMethod("keys",assertKeys),Assertion.addMethod("key",assertKeys),Assertion.addMethod("throw",assertThrows),Assertion.addMethod("throws",assertThrows),Assertion.addMethod("Throw",assertThrows),Assertion.addMethod("respondTo",function(method,msg){msg&&flag(this,"message",msg);var obj=flag(this,"object"),itself=flag(this,"itself"),context="function"!==_.type(obj)||itself?obj[method]:obj.prototype[method];this.assert("function"==typeof context,"expected #{this} to respond to "+_.inspect(method),"expected #{this} to not respond to "+_.inspect(method))}),Assertion.addProperty("itself",function(){flag(this,"itself",!0)}),Assertion.addMethod("satisfy",function(matcher,msg){msg&&flag(this,"message",msg);var obj=flag(this,"object");this.assert(matcher(obj),"expected #{this} to satisfy "+_.objDisplay(matcher),"expected #{this} to not satisfy"+_.objDisplay(matcher),this.negate?!1:!0,matcher(obj))}),Assertion.addMethod("closeTo",function(expected,delta,msg){msg&&flag(this,"message",msg);var obj=flag(this,"object");this.assert(Math.abs(obj-expected)<=delta,"expected #{this} to be close to "+expected+" +/- "+delta,"expected #{this} not to be close to "+expected+" +/- "+delta)})}}),require.register("chai/error.js",function(module){function AssertionError(options){if(options=options||{},this.message=options.message,this.actual=options.actual,this.expected=options.expected,this.operator=options.operator,this.showDiff=options.showDiff,options.stackStartFunction&&Error.captureStackTrace){var stackStartFunction=options.stackStartFunction;Error.captureStackTrace(this,stackStartFunction)}}module.exports=AssertionError,AssertionError.prototype=Object.create(Error.prototype),AssertionError.prototype.name="AssertionError",AssertionError.prototype.constructor=AssertionError,AssertionError.prototype.toString=function(){return this.message}}),require.register("chai/interface/assert.js",function(module,exports,require){module.exports=function(chai,util){var Assertion=chai.Assertion,flag=util.flag,assert=chai.assert=function(express,errmsg){var test=new Assertion(null);test.assert(express,errmsg,"[ negation message unavailable ]")};assert.fail=function(actual,expected,message,operator){throw new chai.AssertionError({actual:actual,expected:expected,message:message,operator:operator,stackStartFunction:assert.fail})},assert.ok=function(val,msg){new Assertion(val,msg).is.ok},assert.equal=function(act,exp,msg){var test=new Assertion(act,msg);test.assert(exp==flag(test,"object"),"expected #{this} to equal #{exp}","expected #{this} to not equal #{act}",exp,act)},assert.notEqual=function(act,exp,msg){var test=new Assertion(act,msg);test.assert(exp!=flag(test,"object"),"expected #{this} to not equal #{exp}","expected #{this} to equal #{act}",exp,act)},assert.strictEqual=function(act,exp,msg){new Assertion(act,msg).to.equal(exp)},assert.notStrictEqual=function(act,exp,msg){new Assertion(act,msg).to.not.equal(exp)},assert.deepEqual=function(act,exp,msg){new Assertion(act,msg).to.eql(exp)},assert.notDeepEqual=function(act,exp,msg){new Assertion(act,msg).to.not.eql(exp)},assert.isTrue=function(val,msg){new Assertion(val,msg).is["true"]},assert.isFalse=function(val,msg){new Assertion(val,msg).is["false"]},assert.isNull=function(val,msg){new Assertion(val,msg).to.equal(null)},assert.isNotNull=function(val,msg){new Assertion(val,msg).to.not.equal(null)},assert.isUndefined=function(val,msg){new Assertion(val,msg).to.equal(void 0)},assert.isDefined=function(val,msg){new Assertion(val,msg).to.not.equal(void 0)},assert.isFunction=function(val,msg){new Assertion(val,msg).to.be.a("function")},assert.isNotFunction=function(val,msg){new Assertion(val,msg).to.not.be.a("function")},assert.isObject=function(val,msg){new Assertion(val,msg).to.be.a("object")},assert.isNotObject=function(val,msg){new Assertion(val,msg).to.not.be.a("object")},assert.isArray=function(val,msg){new Assertion(val,msg).to.be.an("array")},assert.isNotArray=function(val,msg){new Assertion(val,msg).to.not.be.an("array")},assert.isString=function(val,msg){new Assertion(val,msg).to.be.a("string")},assert.isNotString=function(val,msg){new Assertion(val,msg).to.not.be.a("string")},assert.isNumber=function(val,msg){new Assertion(val,msg).to.be.a("number")},assert.isNotNumber=function(val,msg){new Assertion(val,msg).to.not.be.a("number")},assert.isBoolean=function(val,msg){new Assertion(val,msg).to.be.a("boolean")},assert.isNotBoolean=function(val,msg){new Assertion(val,msg).to.not.be.a("boolean")},assert.typeOf=function(val,type,msg){new Assertion(val,msg).to.be.a(type)},assert.notTypeOf=function(val,type,msg){new Assertion(val,msg).to.not.be.a(type)},assert.instanceOf=function(val,type,msg){new Assertion(val,msg).to.be.instanceOf(type)},assert.notInstanceOf=function(val,type,msg){new Assertion(val,msg).to.not.be.instanceOf(type)},assert.include=function(exp,inc,msg){var obj=new Assertion(exp,msg);Array.isArray(exp)?obj.to.include(inc):"string"==typeof exp&&obj.to.contain.string(inc)},assert.match=function(exp,re,msg){new Assertion(exp,msg).to.match(re)},assert.notMatch=function(exp,re,msg){new Assertion(exp,msg).to.not.match(re)},assert.property=function(obj,prop,msg){new Assertion(obj,msg).to.have.property(prop)},assert.notProperty=function(obj,prop,msg){new Assertion(obj,msg).to.not.have.property(prop)},assert.deepProperty=function(obj,prop,msg){new Assertion(obj,msg).to.have.deep.property(prop)},assert.notDeepProperty=function(obj,prop,msg){new Assertion(obj,msg).to.not.have.deep.property(prop)},assert.propertyVal=function(obj,prop,val,msg){new Assertion(obj,msg).to.have.property(prop,val)},assert.propertyNotVal=function(obj,prop,val,msg){new Assertion(obj,msg).to.not.have.property(prop,val)},assert.deepPropertyVal=function(obj,prop,val,msg){new Assertion(obj,msg).to.have.deep.property(prop,val)},assert.deepPropertyNotVal=function(obj,prop,val,msg){new Assertion(obj,msg).to.not.have.deep.property(prop,val)},assert.lengthOf=function(exp,len,msg){new Assertion(exp,msg).to.have.length(len)},assert.Throw=function(fn,errt,errs,msg){("string"==typeof errt||errt instanceof RegExp)&&(errs=errt,errt=null),new Assertion(fn,msg).to.Throw(errt,errs)},assert.doesNotThrow=function(fn,type,msg){"string"==typeof type&&(msg=type,type=null),new Assertion(fn,msg).to.not.Throw(type)},assert.operator=function(val,operator,val2,msg){if(!~["==","===",">",">=","<","<=","!=","!=="].indexOf(operator))throw new Error('Invalid operator "'+operator+'"');var test=new Assertion(eval(val+operator+val2),msg);test.assert(!0===flag(test,"object"),"expected "+util.inspect(val)+" to be "+operator+" "+util.inspect(val2),"expected "+util.inspect(val)+" to not be "+operator+" "+util.inspect(val2))},assert.closeTo=function(act,exp,delta,msg){new Assertion(act,msg).to.be.closeTo(exp,delta)},assert.ifError=function(val,msg){new Assertion(val,msg).to.not.be.ok},function alias(name,as){return assert[as]=assert[name],alias}("Throw","throw")("Throw","throws")}}),require.register("chai/interface/expect.js",function(module){module.exports=function(chai){chai.expect=function(val,message){return new chai.Assertion(val,message)}}}),require.register("chai/interface/should.js",function(module){module.exports=function(chai){function loadShould(){Object.defineProperty(Object.prototype,"should",{set:function(value){Object.defineProperty(this,"should",{value:value,enumerable:!0,configurable:!0,writable:!0})},get:function(){return new Assertion(this instanceof String||this instanceof Number?this.constructor(this):this instanceof Boolean?1==this:this)},configurable:!0});var should={};return should.equal=function(val1,val2,msg){new Assertion(val1,msg).to.equal(val2)},should.Throw=function(fn,errt,errs,msg){new Assertion(fn,msg).to.Throw(errt,errs)},should.exist=function(val,msg){new Assertion(val,msg).to.exist},should.not={},should.not.equal=function(val1,val2,msg){new Assertion(val1,msg).to.not.equal(val2)},should.not.Throw=function(fn,errt,errs,msg){new Assertion(fn,msg).to.not.Throw(errt,errs)},should.not.exist=function(val,msg){new Assertion(val,msg).to.not.exist},should["throw"]=should.Throw,should.not["throw"]=should.not.Throw,should}var Assertion=chai.Assertion;chai.should=loadShould,chai.Should=loadShould}}),require.register("chai/utils/addChainableMethod.js",function(module,exports,require){var transferFlags=require("./transferFlags"),hasProtoSupport="__proto__"in Object,excludeNames=/^(?:length|name|arguments|caller)$/;module.exports=function(ctx,name,method,chainingBehavior){"function"!=typeof chainingBehavior&&(chainingBehavior=function(){}),Object.defineProperty(ctx,name,{get:function(){chainingBehavior.call(this);var assert=function(){var result=method.apply(this,arguments);return void 0===result?this:result};if(hasProtoSupport)assert.__proto__=this;else{var asserterNames=Object.getOwnPropertyNames(ctx);asserterNames.forEach(function(asserterName){if(!excludeNames.test(asserterName)){var pd=Object.getOwnPropertyDescriptor(ctx,asserterName);Object.defineProperty(assert,asserterName,pd)}})}return transferFlags(this,assert),assert},configurable:!0})}}),require.register("chai/utils/addMethod.js",function(module){module.exports=function(ctx,name,method){ctx[name]=function(){var result=method.apply(this,arguments);return void 0===result?this:result}}}),require.register("chai/utils/addProperty.js",function(module){module.exports=function(ctx,name,getter){Object.defineProperty(ctx,name,{get:function(){var result=getter.call(this);return void 0===result?this:result},configurable:!0})}}),require.register("chai/utils/eql.js",function(module,exports,require){function _deepEqual(actual,expected,memos){if(actual===expected)return!0;if(Buffer.isBuffer(actual)&&Buffer.isBuffer(expected)){if(actual.length!=expected.length)return!1;for(var i=0;i<actual.length;i++)if(actual[i]!==expected[i])return!1;return!0}return actual instanceof Date&&expected instanceof Date?actual.getTime()===expected.getTime():"object"!=typeof actual&&"object"!=typeof expected?actual===expected:objEquiv(actual,expected,memos)}function isUndefinedOrNull(value){return null===value||void 0===value}function isArguments(object){return"[object Arguments]"==Object.prototype.toString.call(object)}function objEquiv(a,b,memos){if(isUndefinedOrNull(a)||isUndefinedOrNull(b))return!1;if(a.prototype!==b.prototype)return!1;var i;if(memos){for(i=0;i<memos.length;i++)if(memos[i][0]===a&&memos[i][1]===b||memos[i][0]===b&&memos[i][1]===a)return!0}else memos=[];if(isArguments(a))return isArguments(b)?(a=pSlice.call(a),b=pSlice.call(b),_deepEqual(a,b,memos)):!1;try{var key,ka=getEnumerableProperties(a),kb=getEnumerableProperties(b)}catch(e){return!1}if(ka.length!=kb.length)return!1;for(ka.sort(),kb.sort(),i=ka.length-1;i>=0;i--)if(ka[i]!=kb[i])return!1;for(memos.push([a,b]),i=ka.length-1;i>=0;i--)if(key=ka[i],!_deepEqual(a[key],b[key],memos))return!1;return!0}module.exports=_deepEqual;var Buffer,getEnumerableProperties=require("./getEnumerableProperties");try{Buffer=require("buffer").Buffer}catch(ex){Buffer={isBuffer:function(){return!1}}}}),require.register("chai/utils/flag.js",function(module){module.exports=function(obj,key,value){var flags=obj.__flags||(obj.__flags=Object.create(null));return 3!==arguments.length?flags[key]:void(flags[key]=value)}}),require.register("chai/utils/getActual.js",function(module){module.exports=function(obj,args){var actual=args[4];return"undefined"!=typeof actual?actual:obj._obj}}),require.register("chai/utils/getEnumerableProperties.js",function(module){module.exports=function(object){var result=[];for(var name in object)result.push(name);return result}}),require.register("chai/utils/getMessage.js",function(module,exports,require){var flag=require("./flag"),getActual=require("./getActual"),objDisplay=(require("./inspect"),require("./objDisplay"));module.exports=function(obj,args){var negate=flag(obj,"negate"),val=flag(obj,"object"),expected=args[3],actual=getActual(obj,args),msg=negate?args[2]:args[1],flagMsg=flag(obj,"message");return msg=msg||"",msg=msg.replace(/#{this}/g,objDisplay(val)).replace(/#{act}/g,objDisplay(actual)).replace(/#{exp}/g,objDisplay(expected)),flagMsg?flagMsg+": "+msg:msg}}),require.register("chai/utils/getName.js",function(module){module.exports=function(func){if(func.name)return func.name;var match=/^\s?function ([^(]*)\(/.exec(func);return match&&match[1]?match[1]:""}}),require.register("chai/utils/getPathValue.js",function(module){function parsePath(path){var str=path.replace(/\[/g,".["),parts=str.match(/(\\\.|[^.]+?)+/g);return parts.map(function(value){var re=/\[(\d+)\]$/,mArr=re.exec(value);return mArr?{i:parseFloat(mArr[1])}:{p:value}})}function _getPathValue(parsed,obj){for(var res,tmp=obj,i=0,l=parsed.length;l>i;i++){var part=parsed[i];tmp?("undefined"!=typeof part.p?tmp=tmp[part.p]:"undefined"!=typeof part.i&&(tmp=tmp[part.i]),i==l-1&&(res=tmp)):res=void 0}return res}module.exports=function(path,obj){var parsed=parsePath(path);return _getPathValue(parsed,obj)}}),require.register("chai/utils/getProperties.js",function(module){module.exports=function(){function addProperty(property){-1===result.indexOf(property)&&result.push(property)}for(var result=Object.getOwnPropertyNames(subject),proto=Object.getPrototypeOf(subject);null!==proto;)Object.getOwnPropertyNames(proto).forEach(addProperty),proto=Object.getPrototypeOf(proto);return result}}),require.register("chai/utils/index.js",function(module,exports,require){var exports=module.exports={};exports.test=require("./test"),exports.type=require("./type"),exports.getMessage=require("./getMessage"),exports.getActual=require("./getActual"),exports.inspect=require("./inspect"),exports.objDisplay=require("./objDisplay"),exports.flag=require("./flag"),exports.transferFlags=require("./transferFlags"),exports.eql=require("./eql"),exports.getPathValue=require("./getPathValue"),exports.getName=require("./getName"),exports.addProperty=require("./addProperty"),exports.addMethod=require("./addMethod"),exports.overwriteProperty=require("./overwriteProperty"),exports.overwriteMethod=require("./overwriteMethod"),exports.addChainableMethod=require("./addChainableMethod")}),require.register("chai/utils/inspect.js",function(module,exports,require){function inspect(obj,showHidden,depth){var ctx={showHidden:showHidden,seen:[],stylize:function(str){return str}};return formatValue(ctx,obj,"undefined"==typeof depth?2:depth)}function formatValue(ctx,value,recurseTimes){if(value&&"function"==typeof value.inspect&&value.inspect!==exports.inspect&&(!value.constructor||value.constructor.prototype!==value))return value.inspect(recurseTimes);var primitive=formatPrimitive(ctx,value);if(primitive)return primitive;if(isDOMElement(value))return getOuterHTML(value);var visibleKeys=getEnumerableProperties(value),keys=ctx.showHidden?getProperties(value):visibleKeys;if(0===keys.length||isError(value)&&(1===keys.length&&"stack"===keys[0]||2===keys.length&&"description"===keys[0]&&"stack"===keys[1])){if("function"==typeof value){var name=getName(value),nameSuffix=name?": "+name:"";return ctx.stylize("[Function"+nameSuffix+"]","special")}if(isRegExp(value))return ctx.stylize(RegExp.prototype.toString.call(value),"regexp");if(isDate(value))return ctx.stylize(Date.prototype.toUTCString.call(value),"date");if(isError(value))return formatError(value)}var base="",array=!1,braces=["{","}"];if(isArray(value)&&(array=!0,braces=["[","]"]),"function"==typeof value){var name=getName(value),nameSuffix=name?": "+name:"";base=" [Function"+nameSuffix+"]"}if(isRegExp(value)&&(base=" "+RegExp.prototype.toString.call(value)),isDate(value)&&(base=" "+Date.prototype.toUTCString.call(value)),isError(value))return formatError(value);if(0===keys.length&&(!array||0==value.length))return braces[0]+base+braces[1];if(0>recurseTimes)return isRegExp(value)?ctx.stylize(RegExp.prototype.toString.call(value),"regexp"):ctx.stylize("[Object]","special");ctx.seen.push(value);var output;return output=array?formatArray(ctx,value,recurseTimes,visibleKeys,keys):keys.map(function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)}),ctx.seen.pop(),reduceToSingleString(output,base,braces)}function formatPrimitive(ctx,value){switch(typeof value){case"undefined":return ctx.stylize("undefined","undefined");case"string":var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";
return ctx.stylize(simple,"string");case"number":return ctx.stylize(""+value,"number");case"boolean":return ctx.stylize(""+value,"boolean")}return null===value?ctx.stylize("null","null"):void 0}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){for(var output=[],i=0,l=value.length;l>i;++i)output.push(Object.prototype.hasOwnProperty.call(value,String(i))?formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),!0):"");return keys.forEach(function(key){key.match(/^\d+$/)||output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,!0))}),output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str;if(value.__lookupGetter__&&(value.__lookupGetter__(key)?str=value.__lookupSetter__(key)?ctx.stylize("[Getter/Setter]","special"):ctx.stylize("[Getter]","special"):value.__lookupSetter__(key)&&(str=ctx.stylize("[Setter]","special"))),visibleKeys.indexOf(key)<0&&(name="["+key+"]"),str||(ctx.seen.indexOf(value[key])<0?(str=null===recurseTimes?formatValue(ctx,value[key],null):formatValue(ctx,value[key],recurseTimes-1),str.indexOf("\n")>-1&&(str=array?str.split("\n").map(function(line){return"  "+line}).join("\n").substr(2):"\n"+str.split("\n").map(function(line){return"   "+line}).join("\n"))):str=ctx.stylize("[Circular]","special")),"undefined"==typeof name){if(array&&key.match(/^\d+$/))return str;name=JSON.stringify(""+key),name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(name=name.substr(1,name.length-2),name=ctx.stylize(name,"name")):(name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),name=ctx.stylize(name,"string"))}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0,length=output.reduce(function(prev,cur){return numLinesEst++,cur.indexOf("\n")>=0&&numLinesEst++,prev+cur.length+1},0);return length>60?braces[0]+(""===base?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]:braces[0]+base+" "+output.join(", ")+" "+braces[1]}function isArray(ar){return Array.isArray(ar)||"object"==typeof ar&&"[object Array]"===objectToString(ar)}function isRegExp(re){return"object"==typeof re&&"[object RegExp]"===objectToString(re)}function isDate(d){return"object"==typeof d&&"[object Date]"===objectToString(d)}function isError(e){return"object"==typeof e&&"[object Error]"===objectToString(e)}function objectToString(o){return Object.prototype.toString.call(o)}var getName=require("./getName"),getProperties=require("./getProperties"),getEnumerableProperties=require("./getEnumerableProperties");module.exports=inspect;var getOuterHTML=function(element){if("outerHTML"in element)return element.outerHTML;var html,ns="http://www.w3.org/1999/xhtml",container=document.createElementNS(ns,"_"),xmlSerializer=((window.HTMLElement||window.Element).prototype,new XMLSerializer);return document.xmlVersion?xmlSerializer.serializeToString(element):(container.appendChild(element.cloneNode(!1)),html=container.innerHTML.replace("><",">"+element.innerHTML+"<"),container.innerHTML="",html)},isDOMElement=function(object){return"object"==typeof HTMLElement?object instanceof HTMLElement:object&&"object"==typeof object&&1===object.nodeType&&"string"==typeof object.nodeName}}),require.register("chai/utils/objDisplay.js",function(module,exports,require){var inspect=require("./inspect");module.exports=function(obj){var str=inspect(obj),type=Object.prototype.toString.call(obj);if(str.length>=40){if("[object Function]"===type)return obj.name&&""!==obj.name?"[Function: "+obj.name+"]":"[Function]";if("[object Array]"===type)return"[ Array("+obj.length+") ]";if("[object Object]"===type){var keys=Object.keys(obj),kstr=keys.length>2?keys.splice(0,2).join(", ")+", ...":keys.join(", ");return"{ Object ("+kstr+") }"}return str}return str}}),require.register("chai/utils/overwriteMethod.js",function(module){module.exports=function(ctx,name,method){var _method=ctx[name],_super=function(){return this};_method&&"function"==typeof _method&&(_super=_method),ctx[name]=function(){var result=method(_super).apply(this,arguments);return void 0===result?this:result}}}),require.register("chai/utils/overwriteProperty.js",function(module){module.exports=function(ctx,name,getter){var _get=Object.getOwnPropertyDescriptor(ctx,name),_super=function(){};_get&&"function"==typeof _get.get&&(_super=_get.get),Object.defineProperty(ctx,name,{get:function(){var result=getter(_super).call(this);return void 0===result?this:result},configurable:!0})}}),require.register("chai/utils/test.js",function(module,exports,require){var flag=require("./flag");module.exports=function(obj,args){var negate=flag(obj,"negate"),expr=args[0];return negate?!expr:expr}}),require.register("chai/utils/transferFlags.js",function(module){module.exports=function(assertion,object,includeAll){var flags=assertion.__flags||(assertion.__flags=Object.create(null));object.__flags||(object.__flags=Object.create(null)),includeAll=3===arguments.length?includeAll:!0;for(var flag in flags)(includeAll||"object"!==flag&&"ssfi"!==flag&&"message"!=flag)&&(object.__flags[flag]=flags[flag])}}),require.register("chai/utils/type.js",function(module){var natives={"[object Arguments]":"arguments","[object Array]":"array","[object Date]":"date","[object Function]":"function","[object Number]":"number","[object RegExp]":"regexp","[object String]":"string"};module.exports=function(obj){var str=Object.prototype.toString.call(obj);return natives[str]?natives[str]:null===obj?"null":void 0===obj?"undefined":obj===Object(obj)?"object":typeof obj}}),require.alias("./chai.js","chai"),require("chai")}),function(){function require(p){var path=require.resolve(p),mod=require.modules[path];if(!mod)throw new Error('failed to require "'+p+'"');return mod.exports||(mod.exports={},mod.call(mod.exports,mod,mod.exports,require.relative(path))),mod.exports}require.modules={},require.resolve=function(path){var orig=path,reg=path+".js",index=path+"/index.js";return require.modules[reg]&&reg||require.modules[index]&&index||orig},require.register=function(path,fn){require.modules[path]=fn},require.relative=function(parent){return function(p){if("."!=p.charAt(0))return require(p);var path=parent.split("/"),segs=p.split("/");path.pop();for(var i=0;i<segs.length;i++){var seg=segs[i];".."==seg?path.pop():"."!=seg&&path.push(seg)}return require(path.join("/"))}},require.register("browser/debug.js",function(module){module.exports=function(){return function(){}}}),require.register("browser/diff.js",function(module){var JsDiff=function(){function clonePath(path){return{newPos:path.newPos,components:path.components.slice(0)}}function removeEmpty(array){for(var ret=[],i=0;i<array.length;i++)array[i]&&ret.push(array[i]);return ret}function escapeHTML(s){var n=s;return n=n.replace(/&/g,"&amp;"),n=n.replace(/</g,"&lt;"),n=n.replace(/>/g,"&gt;"),n=n.replace(/"/g,"&quot;")}var fbDiff=function(ignoreWhitespace){this.ignoreWhitespace=ignoreWhitespace};fbDiff.prototype={diff:function(oldString,newString){if(newString==oldString)return[{value:newString}];if(!newString)return[{value:oldString,removed:!0}];if(!oldString)return[{value:newString,added:!0}];newString=this.tokenize(newString),oldString=this.tokenize(oldString);var newLen=newString.length,oldLen=oldString.length,maxEditLength=newLen+oldLen,bestPath=[{newPos:-1,components:[]}],oldPos=this.extractCommon(bestPath[0],newString,oldString,0);if(bestPath[0].newPos+1>=newLen&&oldPos+1>=oldLen)return bestPath[0].components;for(var editLength=1;maxEditLength>=editLength;editLength++)for(var diagonalPath=-1*editLength;editLength>=diagonalPath;diagonalPath+=2){var basePath,addPath=bestPath[diagonalPath-1],removePath=bestPath[diagonalPath+1];oldPos=(removePath?removePath.newPos:0)-diagonalPath,addPath&&(bestPath[diagonalPath-1]=void 0);var canAdd=addPath&&addPath.newPos+1<newLen,canRemove=removePath&&oldPos>=0&&oldLen>oldPos;if(canAdd||canRemove){!canAdd||canRemove&&addPath.newPos<removePath.newPos?(basePath=clonePath(removePath),this.pushComponent(basePath.components,oldString[oldPos],void 0,!0)):(basePath=clonePath(addPath),basePath.newPos++,this.pushComponent(basePath.components,newString[basePath.newPos],!0,void 0));var oldPos=this.extractCommon(basePath,newString,oldString,diagonalPath);if(basePath.newPos+1>=newLen&&oldPos+1>=oldLen)return basePath.components;bestPath[diagonalPath]=basePath}else bestPath[diagonalPath]=void 0}},pushComponent:function(components,value,added,removed){var last=components[components.length-1];last&&last.added===added&&last.removed===removed?components[components.length-1]={value:this.join(last.value,value),added:added,removed:removed}:components.push({value:value,added:added,removed:removed})},extractCommon:function(basePath,newString,oldString,diagonalPath){for(var newLen=newString.length,oldLen=oldString.length,newPos=basePath.newPos,oldPos=newPos-diagonalPath;newLen>newPos+1&&oldLen>oldPos+1&&this.equals(newString[newPos+1],oldString[oldPos+1]);)newPos++,oldPos++,this.pushComponent(basePath.components,newString[newPos],void 0,void 0);return basePath.newPos=newPos,oldPos},equals:function(left,right){var reWhitespace=/\S/;return!this.ignoreWhitespace||reWhitespace.test(left)||reWhitespace.test(right)?left==right:!0},join:function(left,right){return left+right},tokenize:function(value){return value}};var CharDiff=new fbDiff,WordDiff=new fbDiff(!0);WordDiff.tokenize=function(value){return removeEmpty(value.split(/(\s+|\b)/))};var CssDiff=new fbDiff(!0);CssDiff.tokenize=function(value){return removeEmpty(value.split(/([{}:;,]|\s+)/))};var LineDiff=new fbDiff;return LineDiff.tokenize=function(value){return value.split(/^/m)},{diffChars:function(oldStr,newStr){return CharDiff.diff(oldStr,newStr)},diffWords:function(oldStr,newStr){return WordDiff.diff(oldStr,newStr)},diffLines:function(oldStr,newStr){return LineDiff.diff(oldStr,newStr)},diffCss:function(oldStr,newStr){return CssDiff.diff(oldStr,newStr)},createPatch:function(fileName,oldStr,newStr,oldHeader,newHeader){function contextLines(lines){return lines.map(function(entry){return" "+entry})}function eofNL(curRange,i,current){var last=diff[diff.length-2],isLast=i===diff.length-2,isLastOfType=i===diff.length-3&&(current.added===!last.added||current.removed===!last.removed);/\n$/.test(current.value)||!isLast&&!isLastOfType||curRange.push("\\ No newline at end of file")}var ret=[];ret.push("Index: "+fileName),ret.push("==================================================================="),ret.push("--- "+fileName+("undefined"==typeof oldHeader?"":"	"+oldHeader)),ret.push("+++ "+fileName+("undefined"==typeof newHeader?"":"	"+newHeader));var diff=LineDiff.diff(oldStr,newStr);diff[diff.length-1].value||diff.pop(),diff.push({value:"",lines:[]});for(var oldRangeStart=0,newRangeStart=0,curRange=[],oldLine=1,newLine=1,i=0;i<diff.length;i++){var current=diff[i],lines=current.lines||current.value.replace(/\n$/,"").split("\n");if(current.lines=lines,current.added||current.removed){if(!oldRangeStart){var prev=diff[i-1];oldRangeStart=oldLine,newRangeStart=newLine,prev&&(curRange=contextLines(prev.lines.slice(-4)),oldRangeStart-=curRange.length,newRangeStart-=curRange.length)}curRange.push.apply(curRange,lines.map(function(entry){return(current.added?"+":"-")+entry})),eofNL(curRange,i,current),current.added?newLine+=lines.length:oldLine+=lines.length}else{if(oldRangeStart)if(lines.length<=8&&i<diff.length-2)curRange.push.apply(curRange,contextLines(lines));else{var contextSize=Math.min(lines.length,4);ret.push("@@ -"+oldRangeStart+","+(oldLine-oldRangeStart+contextSize)+" +"+newRangeStart+","+(newLine-newRangeStart+contextSize)+" @@"),ret.push.apply(ret,curRange),ret.push.apply(ret,contextLines(lines.slice(0,contextSize))),lines.length<=4&&eofNL(ret,i,current),oldRangeStart=0,newRangeStart=0,curRange=[]}oldLine+=lines.length,newLine+=lines.length}}return ret.join("\n")+"\n"},convertChangesToXML:function(changes){for(var ret=[],i=0;i<changes.length;i++){var change=changes[i];change.added?ret.push("<ins>"):change.removed&&ret.push("<del>"),ret.push(escapeHTML(change.value)),change.added?ret.push("</ins>"):change.removed&&ret.push("</del>")}return ret.join("")}}}();"undefined"!=typeof module&&(module.exports=JsDiff)}),require.register("browser/events.js",function(module,exports){function isArray(obj){return"[object Array]"=={}.toString.call(obj)}function EventEmitter(){}exports.EventEmitter=EventEmitter,EventEmitter.prototype.on=function(name,fn){return this.$events||(this.$events={}),this.$events[name]?isArray(this.$events[name])?this.$events[name].push(fn):this.$events[name]=[this.$events[name],fn]:this.$events[name]=fn,this},EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prototype.once=function(name,fn){function on(){self.removeListener(name,on),fn.apply(this,arguments)}var self=this;return on.listener=fn,this.on(name,on),this},EventEmitter.prototype.removeListener=function(name,fn){if(this.$events&&this.$events[name]){var list=this.$events[name];if(isArray(list)){for(var pos=-1,i=0,l=list.length;l>i;i++)if(list[i]===fn||list[i].listener&&list[i].listener===fn){pos=i;break}if(0>pos)return this;list.splice(pos,1),list.length||delete this.$events[name]}else(list===fn||list.listener&&list.listener===fn)&&delete this.$events[name]}return this},EventEmitter.prototype.removeAllListeners=function(name){return void 0===name?(this.$events={},this):(this.$events&&this.$events[name]&&(this.$events[name]=null),this)},EventEmitter.prototype.listeners=function(name){return this.$events||(this.$events={}),this.$events[name]||(this.$events[name]=[]),isArray(this.$events[name])||(this.$events[name]=[this.$events[name]]),this.$events[name]},EventEmitter.prototype.emit=function(name){if(!this.$events)return!1;var handler=this.$events[name];if(!handler)return!1;var args=[].slice.call(arguments,1);if("function"==typeof handler)handler.apply(this,args);else{if(!isArray(handler))return!1;for(var listeners=handler.slice(),i=0,l=listeners.length;l>i;i++)listeners[i].apply(this,args)}return!0}}),require.register("browser/fs.js",function(){}),require.register("browser/path.js",function(){}),require.register("browser/progress.js",function(module){function Progress(){this.percent=0,this.size(0),this.fontSize(11),this.font("helvetica, arial, sans-serif")}module.exports=Progress,Progress.prototype.size=function(n){return this._size=n,this},Progress.prototype.text=function(str){return this._text=str,this},Progress.prototype.fontSize=function(n){return this._fontSize=n,this},Progress.prototype.font=function(family){return this._font=family,this},Progress.prototype.update=function(n){return this.percent=n,this},Progress.prototype.draw=function(ctx){var percent=Math.min(this.percent,100),size=this._size,half=size/2,x=half,y=half,rad=half-1,fontSize=this._fontSize;ctx.font=fontSize+"px "+this._font;var angle=2*Math.PI*(percent/100);ctx.clearRect(0,0,size,size),ctx.strokeStyle="#9f9f9f",ctx.beginPath(),ctx.arc(x,y,rad,0,angle,!1),ctx.stroke(),ctx.strokeStyle="#eee",ctx.beginPath(),ctx.arc(x,y,rad-1,0,angle,!0),ctx.stroke();var text=this._text||(0|percent)+"%",w=ctx.measureText(text).width;return ctx.fillText(text,x-w/2+1,y+fontSize/2-1),this}}),require.register("browser/tty.js",function(module,exports){exports.isatty=function(){return!0},exports.getWindowSize=function(){return[window.innerHeight,window.innerWidth]}}),require.register("context.js",function(module){function Context(){}module.exports=Context,Context.prototype.runnable=function(runnable){return 0==arguments.length?this._runnable:(this.test=this._runnable=runnable,this)},Context.prototype.timeout=function(ms){return this.runnable().timeout(ms),this},Context.prototype.slow=function(ms){return this.runnable().slow(ms),this},Context.prototype.inspect=function(){return JSON.stringify(this,function(key,val){return"_runnable"!=key&&"test"!=key?val:void 0},2)}}),require.register("hook.js",function(module,exports,require){function Hook(title,fn){Runnable.call(this,title,fn),this.type="hook"}function F(){}var Runnable=require("./runnable");module.exports=Hook,F.prototype=Runnable.prototype,Hook.prototype=new F,Hook.prototype.constructor=Hook,Hook.prototype.error=function(err){if(0==arguments.length){var err=this._error;return this._error=null,err}this._error=err}}),require.register("interfaces/bdd.js",function(module,exports,require){var Suite=require("../suite"),Test=require("../test");module.exports=function(suite){var suites=[suite];suite.on("pre-require",function(context,file,mocha){context.before=function(fn){suites[0].beforeAll(fn)},context.after=function(fn){suites[0].afterAll(fn)},context.beforeEach=function(fn){suites[0].beforeEach(fn)},context.afterEach=function(fn){suites[0].afterEach(fn)},context.describe=context.context=function(title,fn){var suite=Suite.create(suites[0],title);return suites.unshift(suite),fn.call(suite),suites.shift(),suite},context.xdescribe=context.xcontext=context.describe.skip=function(title,fn){var suite=Suite.create(suites[0],title);suite.pending=!0,suites.unshift(suite),fn.call(suite),suites.shift()},context.describe.only=function(title,fn){var suite=context.describe(title,fn);mocha.grep(suite.fullTitle())},context.it=context.specify=function(title,fn){var suite=suites[0];if(suite.pending)var fn=null;var test=new Test(title,fn);return suite.addTest(test),test},context.it.only=function(title,fn){var test=context.it(title,fn);mocha.grep(test.fullTitle())},context.xit=context.xspecify=context.it.skip=function(title){context.it(title)}})}}),require.register("interfaces/exports.js",function(module,exports,require){var Suite=require("../suite"),Test=require("../test");module.exports=function(suite){function visit(obj){var suite;for(var key in obj)if("function"==typeof obj[key]){var fn=obj[key];switch(key){case"before":suites[0].beforeAll(fn);break;case"after":suites[0].afterAll(fn);break;case"beforeEach":suites[0].beforeEach(fn);break;case"afterEach":suites[0].afterEach(fn);break;default:suites[0].addTest(new Test(key,fn))}}else{var suite=Suite.create(suites[0],key);suites.unshift(suite),visit(obj[key]),suites.shift()}}var suites=[suite];suite.on("require",visit)}}),require.register("interfaces/index.js",function(module,exports,require){exports.bdd=require("./bdd"),exports.tdd=require("./tdd"),exports.qunit=require("./qunit"),exports.exports=require("./exports")}),require.register("interfaces/qunit.js",function(module,exports,require){var Suite=require("../suite"),Test=require("../test");module.exports=function(suite){var suites=[suite];suite.on("pre-require",function(context){context.before=function(fn){suites[0].beforeAll(fn)},context.after=function(fn){suites[0].afterAll(fn)},context.beforeEach=function(fn){suites[0].beforeEach(fn)},context.afterEach=function(fn){suites[0].afterEach(fn)},context.suite=function(title){suites.length>1&&suites.shift();var suite=Suite.create(suites[0],title);suites.unshift(suite)},context.test=function(title,fn){suites[0].addTest(new Test(title,fn))}})}}),require.register("interfaces/tdd.js",function(module,exports,require){var Suite=require("../suite"),Test=require("../test");module.exports=function(suite){var suites=[suite];suite.on("pre-require",function(context,file,mocha){context.setup=function(fn){suites[0].beforeEach(fn)},context.teardown=function(fn){suites[0].afterEach(fn)},context.suiteSetup=function(fn){suites[0].beforeAll(fn)},context.suiteTeardown=function(fn){suites[0].afterAll(fn)},context.suite=function(title,fn){var suite=Suite.create(suites[0],title);return suites.unshift(suite),fn.call(suite),suites.shift(),suite},context.suite.only=function(title,fn){var suite=context.suite(title,fn);mocha.grep(suite.fullTitle())},context.test=function(title,fn){var test=new Test(title,fn);return suites[0].addTest(test),test},context.test.only=function(title,fn){var test=context.test(title,fn);mocha.grep(test.fullTitle())},context.test.skip=function(title){context.test(title)}})}}),require.register("mocha.js",function(module,exports,require){function image(name){return __dirname+"/../images/"+name+".png"}function Mocha(options){options=options||{},this.files=[],this.options=options,this.grep(options.grep),this.suite=new exports.Suite("",new exports.Context),this.ui(options.ui),this.bail(options.bail),this.reporter(options.reporter),options.timeout&&this.timeout(options.timeout),options.slow&&this.slow(options.slow)}var path=require("browser/path"),utils=require("./utils");exports=module.exports=Mocha,exports.utils=utils,exports.interfaces=require("./interfaces"),exports.reporters=require("./reporters"),exports.Runnable=require("./runnable"),exports.Context=require("./context"),exports.Runner=require("./runner"),exports.Suite=require("./suite"),exports.Hook=require("./hook"),exports.Test=require("./test"),Mocha.prototype.bail=function(bail){return 0==arguments.length&&(bail=!0),this.suite.bail(bail),this},Mocha.prototype.addFile=function(file){return this.files.push(file),this},Mocha.prototype.reporter=function(reporter){if("function"==typeof reporter)this._reporter=reporter;else{reporter=reporter||"dot";try{this._reporter=require("./reporters/"+reporter)}catch(err){this._reporter=require(reporter)}if(!this._reporter)throw new Error('invalid reporter "'+reporter+'"')}return this},Mocha.prototype.ui=function(name){if(name=name||"bdd",this._ui=exports.interfaces[name],!this._ui)throw new Error('invalid interface "'+name+'"');return this._ui=this._ui(this.suite),this},Mocha.prototype.loadFiles=function(fn){var self=this,suite=this.suite,pending=this.files.length;this.files.forEach(function(file){file=path.resolve(file),suite.emit("pre-require",global,file,self),suite.emit("require",require(file),file,self),suite.emit("post-require",global,file,self),--pending||fn&&fn()})},Mocha.prototype._growl=function(runner,reporter){var notify=require("growl");runner.on("end",function(){var stats=reporter.stats;if(stats.failures){var msg=stats.failures+" of "+runner.total+" tests failed";notify(msg,{name:"mocha",title:"Failed",image:image("error")})}else notify(stats.passes+" tests passed in "+stats.duration+"ms",{name:"mocha",title:"Passed",image:image("ok")})})},Mocha.prototype.grep=function(re){return this.options.grep="string"==typeof re?new RegExp(utils.escapeRegexp(re)):re,this},Mocha.prototype.invert=function(){return this.options.invert=!0,this},Mocha.prototype.ignoreLeaks=function(){return this.options.ignoreLeaks=!0,this},Mocha.prototype.checkLeaks=function(){return this.options.ignoreLeaks=!1,this},Mocha.prototype.growl=function(){return this.options.growl=!0,this},Mocha.prototype.globals=function(globals){return this.options.globals=(this.options.globals||[]).concat(globals),this},Mocha.prototype.timeout=function(timeout){return this.suite.timeout(timeout),this},Mocha.prototype.slow=function(slow){return this.suite.slow(slow),this},Mocha.prototype.asyncOnly=function(){return this.options.asyncOnly=!0,this},Mocha.prototype.run=function(fn){this.files.length&&this.loadFiles();var suite=this.suite,options=this.options,runner=new exports.Runner(suite),reporter=new this._reporter(runner);return runner.ignoreLeaks=options.ignoreLeaks,runner.asyncOnly=options.asyncOnly,options.grep&&runner.grep(options.grep,options.invert),options.globals&&runner.globals(options.globals),options.growl&&this._growl(runner,reporter),runner.run(fn)}}),require.register("ms.js",function(module){function parse(str){var m=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(str);if(m){var n=parseFloat(m[1]),type=(m[2]||"ms").toLowerCase();switch(type){case"years":case"year":case"y":return 315576e5*n;case"days":case"day":case"d":return 864e5*n;case"hours":case"hour":case"h":return 36e5*n;case"minutes":case"minute":case"m":return 6e4*n;case"seconds":case"second":case"s":return 1e3*n;case"ms":return n}}}function format(ms){return ms==d?Math.round(ms/d)+" day":ms>d?Math.round(ms/d)+" days":ms==h?Math.round(ms/h)+" hour":ms>h?Math.round(ms/h)+" hours":ms==m?Math.round(ms/m)+" minute":ms>m?Math.round(ms/m)+" minutes":ms==s?Math.round(ms/s)+" second":ms>s?Math.round(ms/s)+" seconds":ms+" ms"}var s=1e3,m=60*s,h=60*m,d=24*h;module.exports=function(val){return"string"==typeof val?parse(val):format(val)}}),require.register("reporters/base.js",function(module,exports,require){function Base(runner){var stats=this.stats={suites:0,tests:0,passes:0,pending:0,failures:0},failures=this.failures=[];runner&&(this.runner=runner,runner.stats=stats,runner.on("start",function(){stats.start=new Date}),runner.on("suite",function(suite){stats.suites=stats.suites||0,suite.root||stats.suites++}),runner.on("test end",function(){stats.tests=stats.tests||0,stats.tests++}),runner.on("pass",function(test){stats.passes=stats.passes||0;var medium=test.slow()/2;test.speed=test.duration>test.slow()?"slow":test.duration>medium?"medium":"fast",stats.passes++}),runner.on("fail",function(test,err){stats.failures=stats.failures||0,stats.failures++,test.err=err,failures.push(test)}),runner.on("end",function(){stats.end=new Date,stats.duration=new Date-stats.start}),runner.on("pending",function(){stats.pending++}))}function pad(str,len){return str=String(str),Array(len-str.length+1).join(" ")+str}function errorDiff(err,type,escape){return diff["diff"+type](err.actual,err.expected).map(function(str){return escape&&(str.value=str.value.replace(/\t/g,"<tab>").replace(/\r/g,"<CR>").replace(/\n/g,"<LF>\n")),str.added?colorLines("diff added",str.value):str.removed?colorLines("diff removed",str.value):str.value}).join("")}function colorLines(name,str){return str.split("\n").map(function(str){return color(name,str)}).join("\n")}var tty=require("browser/tty"),diff=require("browser/diff"),ms=require("../ms"),Date=global.Date,isatty=(global.setTimeout,global.setInterval,global.clearTimeout,global.clearInterval,tty.isatty(1)&&tty.isatty(2));exports=module.exports=Base,exports.useColors=isatty,exports.colors={pass:90,fail:31,"bright pass":92,"bright fail":91,"bright yellow":93,pending:36,suite:0,"error title":0,"error message":31,"error stack":90,checkmark:32,fast:90,medium:33,slow:31,green:32,light:90,"diff gutter":90,"diff added":42,"diff removed":41},exports.symbols={ok:"",err:"",dot:""},"win32"==process.platform&&(exports.symbols.ok="",exports.symbols.err="",exports.symbols.dot=".");var color=exports.color=function(type,str){return exports.useColors?"["+exports.colors[type]+"m"+str+"[0m":str};exports.window={width:isatty?process.stdout.getWindowSize?process.stdout.getWindowSize(1)[0]:tty.getWindowSize()[1]:75},exports.cursor={hide:function(){process.stdout.write("[?25l")},show:function(){process.stdout.write("[?25h")},deleteLine:function(){process.stdout.write("[2K")},beginningOfLine:function(){process.stdout.write("[0G")},CR:function(){exports.cursor.deleteLine(),exports.cursor.beginningOfLine()}},exports.list=function(failures){console.error(),failures.forEach(function(test,i){var fmt=color("error title","  %s) %s:\n")+color("error message","     %s")+color("error stack","\n%s\n"),err=test.err,message=err.message||"",stack=err.stack||message,index=stack.indexOf(message)+message.length,msg=stack.slice(0,index),actual=err.actual,expected=err.expected,escape=!0;if(err.showDiff&&(escape=!1,err.actual=actual=JSON.stringify(actual,null,2),err.expected=expected=JSON.stringify(expected,null,2)),"string"==typeof actual&&"string"==typeof expected){var len=Math.max(actual.length,expected.length);msg=20>len?errorDiff(err,"Chars",escape):errorDiff(err,"Words",escape);var lines=msg.split("\n");if(lines.length>4){var width=String(lines.length).length;msg=lines.map(function(str,i){return pad(++i,width)+" | "+str}).join("\n")}msg="\n"+color("diff removed","actual")+" "+color("diff added","expected")+"\n\n"+msg+"\n",msg=msg.replace(/^/gm,"      "),fmt=color("error title","  %s) %s:\n%s")+color("error stack","\n%s\n")}stack=stack.slice(index?index+1:index).replace(/^/gm,"  "),console.error(fmt,i+1,test.fullTitle(),msg,stack)})},Base.prototype.epilogue=function(){function pluralize(n){return 1==n?"test":"tests"}var fmt,stats=this.stats;return console.log(),stats.failures?(fmt=color("bright fail","  "+exports.symbols.err)+color("fail"," %d of %d %s failed")+color("light",":"),console.error(fmt,stats.failures,this.runner.total,pluralize(this.runner.total)),Base.list(this.failures),void console.error()):(fmt=color("bright pass"," ")+color("green"," %d %s complete")+color("light"," (%s)"),console.log(fmt,stats.tests||0,pluralize(stats.tests),ms(stats.duration)),stats.pending&&(fmt=color("pending"," ")+color("pending"," %d %s pending"),console.log(fmt,stats.pending,pluralize(stats.pending))),void console.log())}}),require.register("reporters/doc.js",function(module,exports,require){function Doc(runner){function indent(){return Array(indents).join("  ")}Base.call(this,runner);var indents=(this.stats,runner.total,2);runner.on("suite",function(suite){suite.root||(++indents,console.log('%s<section class="suite">',indent()),++indents,console.log("%s<h1>%s</h1>",indent(),utils.escape(suite.title)),console.log("%s<dl>",indent()))}),runner.on("suite end",function(suite){suite.root||(console.log("%s</dl>",indent()),--indents,console.log("%s</section>",indent()),--indents)}),runner.on("pass",function(test){console.log("%s  <dt>%s</dt>",indent(),utils.escape(test.title));var code=utils.escape(utils.clean(test.fn.toString()));console.log("%s  <dd><pre><code>%s</code></pre></dd>",indent(),code)})}var Base=require("./base"),utils=require("../utils");exports=module.exports=Doc}),require.register("reporters/dot.js",function(module,exports,require){function Dot(runner){Base.call(this,runner);var self=this,width=(this.stats,.75*Base.window.width|0),n=0;runner.on("start",function(){process.stdout.write("\n  ")}),runner.on("pending",function(){process.stdout.write(color("pending",Base.symbols.dot))}),runner.on("pass",function(test){++n%width==0&&process.stdout.write("\n  "),process.stdout.write("slow"==test.speed?color("bright yellow",Base.symbols.dot):color(test.speed,Base.symbols.dot))}),runner.on("fail",function(){++n%width==0&&process.stdout.write("\n  "),process.stdout.write(color("fail",Base.symbols.dot))}),runner.on("end",function(){console.log(),self.epilogue()})}function F(){}var Base=require("./base"),color=Base.color;exports=module.exports=Dot,F.prototype=Base.prototype,Dot.prototype=new F,Dot.prototype.constructor=Dot}),require.register("reporters/html-cov.js",function(module,exports,require){function HTMLCov(runner){var jade=require("jade"),file=__dirname+"/templates/coverage.jade",str=fs.readFileSync(file,"utf8"),fn=jade.compile(str,{filename:file}),self=this;JSONCov.call(this,runner,!1),runner.on("end",function(){process.stdout.write(fn({cov:self.cov,coverageClass:coverageClass}))})}function coverageClass(n){return n>=75?"high":n>=50?"medium":n>=25?"low":"terrible"}var JSONCov=require("./json-cov"),fs=require("browser/fs");exports=module.exports=HTMLCov}),require.register("reporters/html.js",function(module,exports,require){function HTML(runner,root){Base.call(this,runner);var progress,ctx,stats=this.stats,stat=(runner.total,fragment(statsTemplate)),items=stat.getElementsByTagName("li"),passes=items[1].getElementsByTagName("em")[0],passesLink=items[1].getElementsByTagName("a")[0],failures=items[2].getElementsByTagName("em")[0],failuresLink=items[2].getElementsByTagName("a")[0],duration=items[3].getElementsByTagName("em")[0],canvas=stat.getElementsByTagName("canvas")[0],report=fragment('<ul id="mocha-report"></ul>'),stack=[report];if(root=root||document.getElementById("mocha"),canvas.getContext){var ratio=window.devicePixelRatio||1;canvas.style.width=canvas.width,canvas.style.height=canvas.height,canvas.width*=ratio,canvas.height*=ratio,ctx=canvas.getContext("2d"),ctx.scale(ratio,ratio),progress=new Progress}return root?(on(passesLink,"click",function(){unhide();var name=/pass/.test(report.className)?"":" pass";report.className=report.className.replace(/fail|pass/g,"")+name,report.className.trim()&&hideSuitesWithout("test pass")
}),on(failuresLink,"click",function(){unhide();var name=/fail/.test(report.className)?"":" fail";report.className=report.className.replace(/fail|pass/g,"")+name,report.className.trim()&&hideSuitesWithout("test fail")}),root.appendChild(stat),root.appendChild(report),progress&&progress.size(40),runner.on("suite",function(suite){if(!suite.root){var url="?grep="+encodeURIComponent(suite.fullTitle()),el=fragment('<li class="suite"><h1><a href="%s">%s</a></h1></li>',url,escape(suite.title));stack[0].appendChild(el),stack.unshift(document.createElement("ul")),el.appendChild(stack[0])}}),runner.on("suite end",function(suite){suite.root||stack.shift()}),runner.on("fail",function(test){"hook"==test.type&&runner.emit("test end",test)}),void runner.on("test end",function(test){window.scrollTo(0,document.body.scrollHeight);var percent=stats.tests/this.total*100|0;progress&&progress.update(percent).draw(ctx);var ms=new Date-stats.start;if(text(passes,stats.passes),text(failures,stats.failures),text(duration,(ms/1e3).toFixed(2)),"passed"==test.state)var el=fragment('<li class="test pass %e"><h2>%e<span class="duration">%ems</span> <a href="?grep=%e" class="replay"></a></h2></li>',test.speed,test.title,test.duration,encodeURIComponent(test.fullTitle()));else if(test.pending)var el=fragment('<li class="test pass pending"><h2>%e</h2></li>',test.title);else{var el=fragment('<li class="test fail"><h2>%e <a href="?grep=%e" class="replay"></a></h2></li>',test.title,encodeURIComponent(test.fullTitle())),str=test.err.stack||test.err.toString();~str.indexOf(test.err.message)||(str=test.err.message+"\n"+str),"[object Error]"==str&&(str=test.err.message),!test.err.stack&&test.err.sourceURL&&void 0!==test.err.line&&(str+="\n("+test.err.sourceURL+":"+test.err.line+")"),el.appendChild(fragment('<pre class="error">%e</pre>',str))}if(!test.pending){var h2=el.getElementsByTagName("h2")[0];on(h2,"click",function(){pre.style.display="none"==pre.style.display?"block":"none"});var pre=fragment("<pre><code>%e</code></pre>",utils.clean(test.fn.toString()));el.appendChild(pre),pre.style.display="none"}stack[0]&&stack[0].appendChild(el)})):error("#mocha div missing, add it to your document")}function error(msg){document.body.appendChild(fragment('<div id="mocha-error">%s</div>',msg))}function fragment(html){var args=arguments,div=document.createElement("div"),i=1;return div.innerHTML=html.replace(/%([se])/g,function(_,type){switch(type){case"s":return String(args[i++]);case"e":return escape(args[i++])}}),div.firstChild}function hideSuitesWithout(classname){for(var suites=document.getElementsByClassName("suite"),i=0;i<suites.length;i++){var els=suites[i].getElementsByClassName(classname);0==els.length&&(suites[i].className+=" hidden")}}function unhide(){for(var els=document.getElementsByClassName("suite hidden"),i=0;i<els.length;++i)els[i].className=els[i].className.replace("suite hidden","suite")}function text(el,str){el.textContent?el.textContent=str:el.innerText=str}function on(el,event,fn){el.addEventListener?el.addEventListener(event,fn,!1):el.attachEvent("on"+event,fn)}{var Base=require("./base"),utils=require("../utils"),Progress=require("../browser/progress"),escape=utils.escape,Date=global.Date;global.setTimeout,global.setInterval,global.clearTimeout,global.clearInterval}exports=module.exports=HTML;var statsTemplate='<ul id="mocha-stats"><li class="progress"><canvas width="40" height="40"></canvas></li><li class="passes"><a href="#">passes:</a> <em>0</em></li><li class="failures"><a href="#">failures:</a> <em>0</em></li><li class="duration">duration: <em>0</em>s</li></ul>'}),require.register("reporters/index.js",function(module,exports,require){exports.Base=require("./base"),exports.Dot=require("./dot"),exports.Doc=require("./doc"),exports.TAP=require("./tap"),exports.JSON=require("./json"),exports.HTML=require("./html"),exports.List=require("./list"),exports.Min=require("./min"),exports.Spec=require("./spec"),exports.Nyan=require("./nyan"),exports.XUnit=require("./xunit"),exports.Markdown=require("./markdown"),exports.Progress=require("./progress"),exports.Landing=require("./landing"),exports.JSONCov=require("./json-cov"),exports.HTMLCov=require("./html-cov"),exports.JSONStream=require("./json-stream"),exports.Teamcity=require("./teamcity")}),require.register("reporters/json-cov.js",function(module,exports,require){function JSONCov(runner,output){var self=this,output=1==arguments.length?!0:output;Base.call(this,runner);var tests=[],failures=[],passes=[];runner.on("test end",function(test){tests.push(test)}),runner.on("pass",function(test){passes.push(test)}),runner.on("fail",function(test){failures.push(test)}),runner.on("end",function(){var cov=global._$jscoverage||{},result=self.cov=map(cov);result.stats=self.stats,result.tests=tests.map(clean),result.failures=failures.map(clean),result.passes=passes.map(clean),output&&process.stdout.write(JSON.stringify(result,null,2))})}function map(cov){var ret={instrumentation:"node-jscoverage",sloc:0,hits:0,misses:0,coverage:0,files:[]};for(var filename in cov){var data=coverage(filename,cov[filename]);ret.files.push(data),ret.hits+=data.hits,ret.misses+=data.misses,ret.sloc+=data.sloc}return ret.files.sort(function(a,b){return a.filename.localeCompare(b.filename)}),ret.sloc>0&&(ret.coverage=ret.hits/ret.sloc*100),ret}function coverage(filename,data){var ret={filename:filename,coverage:0,hits:0,misses:0,sloc:0,source:{}};return data.source.forEach(function(line,num){num++,0===data[num]?(ret.misses++,ret.sloc++):void 0!==data[num]&&(ret.hits++,ret.sloc++),ret.source[num]={source:line,coverage:void 0===data[num]?"":data[num]}}),ret.coverage=ret.hits/ret.sloc*100,ret}function clean(test){return{title:test.title,fullTitle:test.fullTitle(),duration:test.duration}}var Base=require("./base");exports=module.exports=JSONCov}),require.register("reporters/json-stream.js",function(module,exports,require){function List(runner){Base.call(this,runner);var self=this,total=(this.stats,runner.total);runner.on("start",function(){console.log(JSON.stringify(["start",{total:total}]))}),runner.on("pass",function(test){console.log(JSON.stringify(["pass",clean(test)]))}),runner.on("fail",function(test){console.log(JSON.stringify(["fail",clean(test)]))}),runner.on("end",function(){process.stdout.write(JSON.stringify(["end",self.stats]))})}function clean(test){return{title:test.title,fullTitle:test.fullTitle(),duration:test.duration}}{var Base=require("./base");Base.color}exports=module.exports=List}),require.register("reporters/json.js",function(module,exports,require){function JSONReporter(runner){var self=this;Base.call(this,runner);var tests=[],failures=[],passes=[];runner.on("test end",function(test){tests.push(test)}),runner.on("pass",function(test){passes.push(test)}),runner.on("fail",function(test){failures.push(test)}),runner.on("end",function(){var obj={stats:self.stats,tests:tests.map(clean),failures:failures.map(clean),passes:passes.map(clean)};process.stdout.write(JSON.stringify(obj,null,2))})}function clean(test){return{title:test.title,fullTitle:test.fullTitle(),duration:test.duration}}{var Base=require("./base");Base.cursor,Base.color}exports=module.exports=JSONReporter}),require.register("reporters/landing.js",function(module,exports,require){function Landing(runner){function runway(){var buf=Array(width).join("-");return"  "+color("runway",buf)}Base.call(this,runner);var self=this,width=(this.stats,.75*Base.window.width|0),total=runner.total,stream=process.stdout,plane=color("plane",""),crashed=-1,n=0;runner.on("start",function(){stream.write("\n  "),cursor.hide()}),runner.on("test end",function(test){var col=-1==crashed?width*++n/total|0:crashed;"failed"==test.state&&(plane=color("plane crash",""),crashed=col),stream.write("[4F\n\n"),stream.write(runway()),stream.write("\n  "),stream.write(color("runway",Array(col).join(""))),stream.write(plane),stream.write(color("runway",Array(width-col).join("")+"\n")),stream.write(runway()),stream.write("[0m")}),runner.on("end",function(){cursor.show(),console.log(),self.epilogue()})}function F(){}var Base=require("./base"),cursor=Base.cursor,color=Base.color;exports=module.exports=Landing,Base.colors.plane=0,Base.colors["plane crash"]=31,Base.colors.runway=90,F.prototype=Base.prototype,Landing.prototype=new F,Landing.prototype.constructor=Landing}),require.register("reporters/list.js",function(module,exports,require){function List(runner){Base.call(this,runner);var self=this,n=(this.stats,0);runner.on("start",function(){console.log()}),runner.on("test",function(test){process.stdout.write(color("pass","    "+test.fullTitle()+": "))}),runner.on("pending",function(test){var fmt=color("checkmark","  -")+color("pending"," %s");console.log(fmt,test.fullTitle())}),runner.on("pass",function(test){var fmt=color("checkmark","  "+Base.symbols.dot)+color("pass"," %s: ")+color(test.speed,"%dms");cursor.CR(),console.log(fmt,test.fullTitle(),test.duration)}),runner.on("fail",function(test){cursor.CR(),console.log(color("fail","  %d) %s"),++n,test.fullTitle())}),runner.on("end",self.epilogue.bind(self))}function F(){}var Base=require("./base"),cursor=Base.cursor,color=Base.color;exports=module.exports=List,F.prototype=Base.prototype,List.prototype=new F,List.prototype.constructor=List}),require.register("reporters/markdown.js",function(module,exports,require){function Markdown(runner){function title(str){return Array(level).join("#")+" "+str}function mapTOC(suite,obj){var ret=obj;return obj=obj[suite.title]=obj[suite.title]||{suite:suite},suite.suites.forEach(function(suite){mapTOC(suite,obj)}),ret}function stringifyTOC(obj,level){++level;var link,buf="";for(var key in obj)"suite"!=key&&(key&&(link=" - ["+key+"](#"+utils.slug(obj[key].suite.fullTitle())+")\n"),key&&(buf+=Array(level).join("  ")+link),buf+=stringifyTOC(obj[key],level));return--level,buf}function generateTOC(suite){var obj=mapTOC(suite,{});return stringifyTOC(obj,0)}Base.call(this,runner);var level=(this.stats,0),buf="";generateTOC(runner.suite),runner.on("suite",function(suite){++level;var slug=utils.slug(suite.fullTitle());buf+='<a name="'+slug+'"></a>\n',buf+=title(suite.title)+"\n"}),runner.on("suite end",function(){--level}),runner.on("pass",function(test){var code=utils.clean(test.fn.toString());buf+=test.title+".\n",buf+="\n```js\n",buf+=code+"\n",buf+="```\n\n"}),runner.on("end",function(){process.stdout.write("# TOC\n"),process.stdout.write(generateTOC(runner.suite)),process.stdout.write(buf)})}var Base=require("./base"),utils=require("../utils");exports=module.exports=Markdown}),require.register("reporters/min.js",function(module,exports,require){function Min(runner){Base.call(this,runner),runner.on("start",function(){process.stdout.write("[2J"),process.stdout.write("[1;3H")}),runner.on("end",this.epilogue.bind(this))}function F(){}var Base=require("./base");exports=module.exports=Min,F.prototype=Base.prototype,Min.prototype=new F,Min.prototype.constructor=Min}),require.register("reporters/nyan.js",function(module,exports,require){function NyanCat(runner){Base.call(this,runner);{var self=this,width=(this.stats,.75*Base.window.width|0),nyanCatWidth=(this.rainbowColors=self.generateColors(),this.colorIndex=0,this.numberOfLines=4,this.trajectories=[[],[],[],[]],this.nyanCatWidth=11);this.trajectoryWidthMax=width-nyanCatWidth,this.scoreboardWidth=5,this.tick=0}runner.on("start",function(){Base.cursor.hide(),self.draw("start")}),runner.on("pending",function(){self.draw("pending")}),runner.on("pass",function(){self.draw("pass")}),runner.on("fail",function(){self.draw("fail")}),runner.on("end",function(){Base.cursor.show();for(var i=0;i<self.numberOfLines;i++)write("\n");self.epilogue()})}function write(string){process.stdout.write(string)}function F(){}{var Base=require("./base");Base.color}exports=module.exports=NyanCat,NyanCat.prototype.draw=function(status){this.appendRainbow(),this.drawScoreboard(),this.drawRainbow(),this.drawNyanCat(status),this.tick=!this.tick},NyanCat.prototype.drawScoreboard=function(){function draw(color,n){write(" "),write("["+color+"m"+n+"[0m"),write("\n")}var stats=this.stats,colors=Base.colors;draw(colors.green,stats.passes),draw(colors.fail,stats.failures),draw(colors.pending,stats.pending),write("\n"),this.cursorUp(this.numberOfLines)},NyanCat.prototype.appendRainbow=function(){for(var segment=this.tick?"_":"-",rainbowified=this.rainbowify(segment),index=0;index<this.numberOfLines;index++){var trajectory=this.trajectories[index];trajectory.length>=this.trajectoryWidthMax&&trajectory.shift(),trajectory.push(rainbowified)}},NyanCat.prototype.drawRainbow=function(){var self=this;this.trajectories.forEach(function(line){write("["+self.scoreboardWidth+"C"),write(line.join("")),write("\n")}),this.cursorUp(this.numberOfLines)},NyanCat.prototype.drawNyanCat=function(status){var self=this,startWidth=this.scoreboardWidth+this.trajectories[0].length;[0,1,2,3].forEach(function(index){switch(write("["+startWidth+"C"),index){case 0:write("_,------,"),write("\n");break;case 1:var padding=self.tick?"  ":"   ";write("_|"+padding+"/\\_/\\ "),write("\n");break;case 2:var face,padding=self.tick?"_":"__",tail=self.tick?"~":"^";switch(status){case"pass":face="( ^ .^)";break;case"fail":face="( o .o)";break;default:face="( - .-)"}write(tail+"|"+padding+face+" "),write("\n");break;case 3:var padding=self.tick?" ":"  ";write(padding+'""  "" '),write("\n")}}),this.cursorUp(this.numberOfLines)},NyanCat.prototype.cursorUp=function(n){write("["+n+"A")},NyanCat.prototype.cursorDown=function(n){write("["+n+"B")},NyanCat.prototype.generateColors=function(){for(var colors=[],i=0;42>i;i++){var pi3=Math.floor(Math.PI/3),n=i*(1/6),r=Math.floor(3*Math.sin(n)+3),g=Math.floor(3*Math.sin(n+2*pi3)+3),b=Math.floor(3*Math.sin(n+4*pi3)+3);colors.push(36*r+6*g+b+16)}return colors},NyanCat.prototype.rainbowify=function(str){var color=this.rainbowColors[this.colorIndex%this.rainbowColors.length];return this.colorIndex+=1,"[38;5;"+color+"m"+str+"[0m"},F.prototype=Base.prototype,NyanCat.prototype=new F,NyanCat.prototype.constructor=NyanCat}),require.register("reporters/progress.js",function(module,exports,require){function Progress(runner,options){Base.call(this,runner);{var self=this,options=options||{},width=(this.stats,.5*Base.window.width|0),total=runner.total,complete=0;Math.max}options.open=options.open||"[",options.complete=options.complete||"",options.incomplete=options.incomplete||Base.symbols.dot,options.close=options.close||"]",options.verbose=!1,runner.on("start",function(){console.log(),cursor.hide()}),runner.on("test end",function(){complete++;var percent=complete/total,n=width*percent|0,i=width-n;cursor.CR(),process.stdout.write("[J"),process.stdout.write(color("progress","  "+options.open)),process.stdout.write(Array(n).join(options.complete)),process.stdout.write(Array(i).join(options.incomplete)),process.stdout.write(color("progress",options.close)),options.verbose&&process.stdout.write(color("progress"," "+complete+" of "+total))}),runner.on("end",function(){cursor.show(),console.log(),self.epilogue()})}function F(){}var Base=require("./base"),cursor=Base.cursor,color=Base.color;exports=module.exports=Progress,Base.colors.progress=90,F.prototype=Base.prototype,Progress.prototype=new F,Progress.prototype.constructor=Progress}),require.register("reporters/spec.js",function(module,exports,require){function Spec(runner){function indent(){return Array(indents).join("  ")}Base.call(this,runner);var self=this,indents=(this.stats,0),n=0;runner.on("start",function(){console.log()}),runner.on("suite",function(suite){++indents,console.log(color("suite","%s%s"),indent(),suite.title)}),runner.on("suite end",function(){--indents,1==indents&&console.log()}),runner.on("test",function(test){process.stdout.write(indent()+color("pass","   "+test.title+": "))}),runner.on("pending",function(test){var fmt=indent()+color("pending","  - %s");console.log(fmt,test.title)}),runner.on("pass",function(test){if("fast"==test.speed){var fmt=indent()+color("checkmark","  "+Base.symbols.ok)+color("pass"," %s ");cursor.CR(),console.log(fmt,test.title)}else{var fmt=indent()+color("checkmark","  "+Base.symbols.ok)+color("pass"," %s ")+color(test.speed,"(%dms)");cursor.CR(),console.log(fmt,test.title,test.duration)}}),runner.on("fail",function(test){cursor.CR(),console.log(indent()+color("fail","  %d) %s"),++n,test.title)}),runner.on("end",self.epilogue.bind(self))}function F(){}var Base=require("./base"),cursor=Base.cursor,color=Base.color;exports=module.exports=Spec,F.prototype=Base.prototype,Spec.prototype=new F,Spec.prototype.constructor=Spec}),require.register("reporters/tap.js",function(module,exports,require){function TAP(runner){Base.call(this,runner);var n=(this.stats,1),passes=0,failures=0;runner.on("start",function(){var total=runner.grepTotal(runner.suite);console.log("%d..%d",1,total)}),runner.on("test end",function(){++n}),runner.on("pending",function(test){console.log("ok %d %s # SKIP -",n,title(test))}),runner.on("pass",function(test){passes++,console.log("ok %d %s",n,title(test))}),runner.on("fail",function(test,err){failures++,console.log("not ok %d %s",n,title(test)),err.stack&&console.log(err.stack.replace(/^/gm,"  "))}),runner.on("end",function(){console.log("# tests "+(passes+failures)),console.log("# pass "+passes),console.log("# fail "+failures)})}function title(test){return test.fullTitle().replace(/#/g,"")}{var Base=require("./base");Base.cursor,Base.color}exports=module.exports=TAP}),require.register("reporters/teamcity.js",function(module,exports,require){function Teamcity(runner){Base.call(this,runner);var stats=this.stats;runner.on("start",function(){console.log("##teamcity[testSuiteStarted name='mocha.suite']")}),runner.on("test",function(test){console.log("##teamcity[testStarted name='"+escape(test.fullTitle())+"']")}),runner.on("fail",function(test,err){console.log("##teamcity[testFailed name='"+escape(test.fullTitle())+"' message='"+escape(err.message)+"']")}),runner.on("pending",function(test){console.log("##teamcity[testIgnored name='"+escape(test.fullTitle())+"' message='pending']")}),runner.on("test end",function(test){console.log("##teamcity[testFinished name='"+escape(test.fullTitle())+"' duration='"+test.duration+"']")}),runner.on("end",function(){console.log("##teamcity[testSuiteFinished name='mocha.suite' duration='"+stats.duration+"']")})}function escape(str){return str.replace(/\|/g,"||").replace(/\n/g,"|n").replace(/\r/g,"|r").replace(/\[/g,"|[").replace(/\]/g,"|]").replace(/\u0085/g,"|x").replace(/\u2028/g,"|l").replace(/\u2029/g,"|p").replace(/'/g,"|'")}var Base=require("./base");exports=module.exports=Teamcity}),require.register("reporters/xunit.js",function(module,exports,require){function XUnit(runner){Base.call(this,runner);var stats=this.stats,tests=[];runner.on("pass",function(test){tests.push(test)}),runner.on("fail",function(test){tests.push(test)}),runner.on("end",function(){console.log(tag("testsuite",{name:"Mocha Tests",tests:stats.tests,failures:stats.failures,errors:stats.failures,skip:stats.tests-stats.failures-stats.passes,timestamp:(new Date).toUTCString(),time:stats.duration/1e3},!1)),tests.forEach(test),console.log("</testsuite>")})}function F(){}function test(test){var attrs={classname:test.parent.fullTitle(),name:test.title,time:test.duration/1e3};if("failed"==test.state){var err=test.err;attrs.message=escape(err.message),console.log(tag("testcase",attrs,!1,tag("failure",attrs,!1,cdata(err.stack))))}else console.log(test.pending?tag("testcase",attrs,!1,tag("skipped",{},!0)):tag("testcase",attrs,!0))}function tag(name,attrs,close,content){var tag,end=close?"/>":">",pairs=[];for(var key in attrs)pairs.push(key+'="'+escape(attrs[key])+'"');return tag="<"+name+(pairs.length?" "+pairs.join(" "):"")+end,content&&(tag+=content+"</"+name+end),tag}function cdata(str){return"<![CDATA["+escape(str)+"]]>"}{var Base=require("./base"),utils=require("../utils"),escape=utils.escape,Date=global.Date;global.setTimeout,global.setInterval,global.clearTimeout,global.clearInterval}exports=module.exports=XUnit,F.prototype=Base.prototype,XUnit.prototype=new F,XUnit.prototype.constructor=XUnit}),require.register("runnable.js",function(module,exports,require){function Runnable(title,fn){this.title=title,this.fn=fn,this.async=fn&&fn.length,this.sync=!this.async,this._timeout=2e3,this._slow=75,this.timedOut=!1}function F(){}var EventEmitter=require("browser/events").EventEmitter,debug=require("browser/debug")("mocha:runnable"),milliseconds=require("./ms"),Date=global.Date,setTimeout=global.setTimeout,clearTimeout=(global.setInterval,global.clearTimeout),toString=(global.clearInterval,Object.prototype.toString);module.exports=Runnable,F.prototype=EventEmitter.prototype,Runnable.prototype=new F,Runnable.prototype.constructor=Runnable,Runnable.prototype.timeout=function(ms){return 0==arguments.length?this._timeout:("string"==typeof ms&&(ms=milliseconds(ms)),debug("timeout %d",ms),this._timeout=ms,this.timer&&this.resetTimeout(),this)},Runnable.prototype.slow=function(ms){return 0===arguments.length?this._slow:("string"==typeof ms&&(ms=milliseconds(ms)),debug("timeout %d",ms),this._slow=ms,this)},Runnable.prototype.fullTitle=function(){return this.parent.fullTitle()+" "+this.title},Runnable.prototype.clearTimeout=function(){clearTimeout(this.timer)},Runnable.prototype.inspect=function(){return JSON.stringify(this,function(key,val){return"_"!=key[0]?"parent"==key?"#<Suite>":"ctx"==key?"#<Context>":val:void 0},2)},Runnable.prototype.resetTimeout=function(){var self=this,ms=this.timeout();this.clearTimeout(),ms&&(this.timer=setTimeout(function(){self.callback(new Error("timeout of "+ms+"ms exceeded")),self.timedOut=!0},ms))},Runnable.prototype.run=function(fn){function multiple(err){emitted||(emitted=!0,self.emit("error",err||new Error("done() called multiple times")))}function done(err){if(!self.timedOut){if(finished)return multiple(err);self.clearTimeout(),self.duration=new Date-start,finished=!0,fn(err)}}var finished,emitted,self=this,ms=this.timeout(),start=new Date,ctx=this.ctx;if(ctx&&ctx.runnable(this),this.async&&ms&&(this.timer=setTimeout(function(){done(new Error("timeout of "+ms+"ms exceeded")),self.timedOut=!0},ms)),this.callback=done,this.async)try{this.fn.call(ctx,function(err){return err instanceof Error||"[object Error]"===toString.call(err)?done(err):null!=err?done(new Error("done() invoked with non-Error: "+err)):void done()})}catch(err){done(err)}else{if(this.asyncOnly)return done(new Error("--async-only option in use without declaring `done()`"));try{this.pending||this.fn.call(ctx),this.duration=new Date-start,fn()}catch(err){fn(err)}}}}),require.register("runner.js",function(module,exports,require){function Runner(suite){var self=this;this._globals=[],this.suite=suite,this.total=suite.total(),this.failures=0,this.on("test end",function(test){self.checkGlobals(test)}),this.on("hook end",function(hook){self.checkGlobals(hook)}),this.grep(/.*/),this.globals(this.globalProps().concat(["errno"]))}function F(){}function filterLeaks(ok,globals){return filter(globals,function(key){var matched=filter(ok,function(ok){return~ok.indexOf("*")?0==key.indexOf(ok.split("*")[0]):/^mocha-/.test(key)?!0:key==ok});return 0==matched.length&&(!global.navigator||"onerror"!==key)})}var EventEmitter=require("browser/events").EventEmitter,debug=require("browser/debug")("mocha:runner"),utils=(require("./test"),require("./utils")),filter=utils.filter,immediately=(utils.keys,global.setImmediate||process.nextTick),globals=["setTimeout","clearTimeout","setInterval","clearInterval","XMLHttpRequest","Date"];module.exports=Runner,F.prototype=EventEmitter.prototype,Runner.prototype=new F,Runner.prototype.constructor=Runner,Runner.prototype.grep=function(re,invert){return debug("grep %s",re),this._grep=re,this._invert=invert,this.total=this.grepTotal(this.suite),this},Runner.prototype.grepTotal=function(suite){var self=this,total=0;return suite.eachTest(function(test){var match=self._grep.test(test.fullTitle());self._invert&&(match=!match),match&&total++}),total},Runner.prototype.globalProps=function(){for(var props=utils.keys(global),i=0;i<globals.length;++i)~utils.indexOf(props,globals[i])||props.push(globals[i]);return props},Runner.prototype.globals=function(arr){return 0==arguments.length?this._globals:(debug("globals %j",arr),utils.forEach(arr,function(arr){this._globals.push(arr)},this),this)},Runner.prototype.checkGlobals=function(test){if(!this.ignoreLeaks){var leaks,ok=this._globals,globals=this.globalProps(),isNode=process.kill;isNode&&1==ok.length-globals.length||2!=ok.length-globals.length&&(leaks=filterLeaks(ok,globals),this._globals=this._globals.concat(leaks),leaks.length>1?this.fail(test,new Error("global leaks detected: "+leaks.join(", "))):leaks.length&&this.fail(test,new Error("global leak detected: "+leaks[0])))}},Runner.prototype.fail=function(test,err){++this.failures,test.state="failed","string"==typeof err&&(err=new Error('the string "'+err+'" was thrown, throw an Error :)')),this.emit("fail",test,err)},Runner.prototype.failHook=function(hook,err){this.fail(hook,err),this.emit("end")},Runner.prototype.hook=function(name,fn){function next(i){var hook=hooks[i];return hook?(self.currentRunnable=hook,self.emit("hook",hook),hook.on("error",function(err){self.failHook(hook,err)}),void hook.run(function(err){hook.removeAllListeners("error");var testError=hook.error();return testError&&self.fail(self.test,testError),err?self.failHook(hook,err):(self.emit("hook end",hook),void next(++i))})):fn()}var suite=this.suite,hooks=suite["_"+name],self=this;immediately(function(){next(0)})},Runner.prototype.hooks=function(name,suites,fn){function next(suite){return self.suite=suite,suite?void self.hook(name,function(err){return err?(self.suite=orig,fn(err)):void next(suites.pop())}):(self.suite=orig,fn())}var self=this,orig=this.suite;next(suites.pop())},Runner.prototype.hookUp=function(name,fn){var suites=[this.suite].concat(this.parents()).reverse();this.hooks(name,suites,fn)},Runner.prototype.hookDown=function(name,fn){var suites=[this.suite].concat(this.parents());this.hooks(name,suites,fn)},Runner.prototype.parents=function(){for(var suite=this.suite,suites=[];suite=suite.parent;)suites.push(suite);return suites},Runner.prototype.runTest=function(fn){var test=this.test,self=this;this.asyncOnly&&(test.asyncOnly=!0);try{test.on("error",function(err){self.fail(test,err)}),test.run(fn)}catch(err){fn(err)}},Runner.prototype.runTests=function(suite,fn){function next(){if(self.failures&&suite._bail)return fn();if(test=tests.shift(),!test)return fn();var match=self._grep.test(test.fullTitle());return self._invert&&(match=!match),match?test.pending?(self.emit("pending",test),self.emit("test end",test),next()):(self.emit("test",self.test=test),void self.hookDown("beforeEach",function(){self.currentRunnable=self.test,self.runTest(function(err){return test=self.test,err?(self.fail(test,err),self.emit("test end",test),self.hookUp("afterEach",next)):(test.state="passed",self.emit("pass",test),self.emit("test end",test),void self.hookUp("afterEach",next))})})):next()}var test,self=this,tests=suite.tests.slice();this.next=next,next()},Runner.prototype.runSuite=function(suite,fn){function next(){var curr=suite.suites[i++];return curr?void self.runSuite(curr,next):done()}function done(){self.suite=suite,self.hook("afterAll",function(){self.emit("suite end",suite),fn()})}var total=this.grepTotal(suite),self=this,i=0;return debug("run suite %s",suite.fullTitle()),total?(this.emit("suite",this.suite=suite),void this.hook("beforeAll",function(){self.runTests(suite,next)})):fn()},Runner.prototype.uncaught=function(err){debug("uncaught exception %s",err.message);var runnable=this.currentRunnable;if(runnable&&"failed"!=runnable.state)return runnable.clearTimeout(),err.uncaught=!0,this.fail(runnable,err),"test"==runnable.type?(this.emit("test end",runnable),void this.hookUp("afterEach",this.next)):void this.emit("end")},Runner.prototype.run=function(fn){function uncaught(err){self.uncaught(err)}var self=this,fn=fn||function(){};return debug("start"),this.on("end",function(){debug("end"),process.removeListener("uncaughtException",uncaught),fn(self.failures)}),this.emit("start"),this.runSuite(this.suite,function(){debug("finished running"),self.emit("end")}),process.on("uncaughtException",uncaught),this}}),require.register("suite.js",function(module,exports,require){function Suite(title,ctx){this.title=title,this.ctx=ctx,this.suites=[],this.tests=[],this.pending=!1,this._beforeEach=[],this._beforeAll=[],this._afterEach=[],this._afterAll=[],this.root=!title,this._timeout=2e3,this._slow=75,this._bail=!1}function F(){}var EventEmitter=require("browser/events").EventEmitter,debug=require("browser/debug")("mocha:suite"),milliseconds=require("./ms"),utils=require("./utils"),Hook=require("./hook");exports=module.exports=Suite,exports.create=function(parent,title){var suite=new Suite(title,parent.ctx);return suite.parent=parent,parent.pending&&(suite.pending=!0),title=suite.fullTitle(),parent.addSuite(suite),suite},F.prototype=EventEmitter.prototype,Suite.prototype=new F,Suite.prototype.constructor=Suite,Suite.prototype.clone=function(){var suite=new Suite(this.title);return debug("clone"),suite.ctx=this.ctx,suite.timeout(this.timeout()),suite.slow(this.slow()),suite.bail(this.bail()),suite},Suite.prototype.timeout=function(ms){return 0==arguments.length?this._timeout:("string"==typeof ms&&(ms=milliseconds(ms)),debug("timeout %d",ms),this._timeout=parseInt(ms,10),this)},Suite.prototype.slow=function(ms){return 0===arguments.length?this._slow:("string"==typeof ms&&(ms=milliseconds(ms)),debug("slow %d",ms),this._slow=ms,this)},Suite.prototype.bail=function(bail){return 0==arguments.length?this._bail:(debug("bail %s",bail),this._bail=bail,this)},Suite.prototype.beforeAll=function(fn){if(this.pending)return this;var hook=new Hook('"before all" hook',fn);return hook.parent=this,hook.timeout(this.timeout()),hook.slow(this.slow()),hook.ctx=this.ctx,this._beforeAll.push(hook),this.emit("beforeAll",hook),this},Suite.prototype.afterAll=function(fn){if(this.pending)return this;var hook=new Hook('"after all" hook',fn);return hook.parent=this,hook.timeout(this.timeout()),hook.slow(this.slow()),hook.ctx=this.ctx,this._afterAll.push(hook),this.emit("afterAll",hook),this},Suite.prototype.beforeEach=function(fn){if(this.pending)return this;var hook=new Hook('"before each" hook',fn);return hook.parent=this,hook.timeout(this.timeout()),hook.slow(this.slow()),hook.ctx=this.ctx,this._beforeEach.push(hook),this.emit("beforeEach",hook),this},Suite.prototype.afterEach=function(fn){if(this.pending)return this;var hook=new Hook('"after each" hook',fn);return hook.parent=this,hook.timeout(this.timeout()),hook.slow(this.slow()),hook.ctx=this.ctx,this._afterEach.push(hook),this.emit("afterEach",hook),this},Suite.prototype.addSuite=function(suite){return suite.parent=this,suite.timeout(this.timeout()),suite.slow(this.slow()),suite.bail(this.bail()),this.suites.push(suite),this.emit("suite",suite),this},Suite.prototype.addTest=function(test){return test.parent=this,test.timeout(this.timeout()),test.slow(this.slow()),test.ctx=this.ctx,this.tests.push(test),this.emit("test",test),this},Suite.prototype.fullTitle=function(){if(this.parent){var full=this.parent.fullTitle();if(full)return full+" "+this.title}return this.title},Suite.prototype.total=function(){return utils.reduce(this.suites,function(sum,suite){return sum+suite.total()},0)+this.tests.length},Suite.prototype.eachTest=function(fn){return utils.forEach(this.tests,fn),utils.forEach(this.suites,function(suite){suite.eachTest(fn)}),this}}),require.register("test.js",function(module,exports,require){function Test(title,fn){Runnable.call(this,title,fn),this.pending=!fn,this.type="test"}function F(){}var Runnable=require("./runnable");module.exports=Test,F.prototype=Runnable.prototype,Test.prototype=new F,Test.prototype.constructor=Test
}),require.register("utils.js",function(module,exports,require){function ignored(path){return!~ignore.indexOf(path)}function highlight(js){return js.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\/\/(.*)/gm,'<span class="comment">//$1</span>').replace(/('.*?')/gm,'<span class="string">$1</span>').replace(/(\d+\.\d+)/gm,'<span class="number">$1</span>').replace(/(\d+)/gm,'<span class="number">$1</span>').replace(/\bnew *(\w+)/gm,'<span class="keyword">new</span> <span class="init">$1</span>').replace(/\b(function|new|throw|return|var|if|else)\b/gm,'<span class="keyword">$1</span>')}var fs=require("browser/fs"),path=require("browser/path"),join=path.join,debug=require("browser/debug")("mocha:watch"),ignore=["node_modules",".git"];exports.escape=function(html){return String(html).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},exports.forEach=function(arr,fn,scope){for(var i=0,l=arr.length;l>i;i++)fn.call(scope,arr[i],i)},exports.indexOf=function(arr,obj,start){for(var i=start||0,l=arr.length;l>i;i++)if(arr[i]===obj)return i;return-1},exports.reduce=function(arr,fn,val){for(var rval=val,i=0,l=arr.length;l>i;i++)rval=fn(rval,arr[i],i,arr);return rval},exports.filter=function(arr,fn){for(var ret=[],i=0,l=arr.length;l>i;i++){var val=arr[i];fn(val,i,arr)&&ret.push(val)}return ret},exports.keys=Object.keys||function(obj){var keys=[],has=Object.prototype.hasOwnProperty;for(var key in obj)has.call(obj,key)&&keys.push(key);return keys},exports.watch=function(files,fn){var options={interval:100};files.forEach(function(file){debug("file %s",file),fs.watchFile(file,options,function(curr,prev){prev.mtime<curr.mtime&&fn(file)})})},exports.files=function(dir,ret){return ret=ret||[],fs.readdirSync(dir).filter(ignored).forEach(function(path){path=join(dir,path),fs.statSync(path).isDirectory()?exports.files(path,ret):path.match(/\.(js|coffee)$/)&&ret.push(path)}),ret},exports.slug=function(str){return str.toLowerCase().replace(/ +/g,"-").replace(/[^-\w]/g,"")},exports.clean=function(str){str=str.replace(/^function *\(.*\) *{/,"").replace(/\s+\}$/,"");var spaces=str.match(/^\n?( *)/)[1].length,re=new RegExp("^ {"+spaces+"}","gm");return str=str.replace(re,""),exports.trim(str)},exports.escapeRegexp=function(str){return str.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")},exports.trim=function(str){return str.replace(/^\s+|\s+$/g,"")},exports.parseQuery=function(qs){return exports.reduce(qs.replace("?","").split("&"),function(obj,pair){var i=pair.indexOf("="),key=pair.slice(0,i),val=pair.slice(++i);return obj[key]=decodeURIComponent(val),obj},{})},exports.highlightTags=function(name){for(var code=document.getElementsByTagName(name),i=0,len=code.length;len>i;++i)code[i].innerHTML=highlight(code[i].innerHTML)}}),process={},process.exit=function(){},process.stdout={},global=window,process.nextTick=function(){if(window.ActiveXObject||!window.postMessage)return function(fn){fn()};var timeouts=[],name="mocha-zero-timeout";return window.addEventListener("message",function(e){e.source==window&&e.data==name&&(e.stopPropagation&&e.stopPropagation(),timeouts.length&&timeouts.shift()())},!0),function(fn){timeouts.push(fn),window.postMessage(name,"*")}}(),process.removeListener=function(e){"uncaughtException"==e&&(window.onerror=null)},process.on=function(e,fn){"uncaughtException"==e&&(window.onerror=function(err,url,line){fn(new Error(err+" ("+url+":"+line+")"))})},function(){var Mocha=window.Mocha=require("mocha"),mocha=window.mocha=new Mocha({reporter:"html"});mocha.ui=function(ui){return Mocha.prototype.ui.call(this,ui),this.suite.emit("pre-require",window,null,this),this},mocha.setup=function(opts){"string"==typeof opts&&(opts={ui:opts});for(var opt in opts)this[opt](opts[opt]);return this},mocha.run=function(fn){mocha.options;mocha.globals("location");var query=Mocha.utils.parseQuery(window.location.search||"");return query.grep&&mocha.grep(query.grep),query.invert&&mocha.invert(),Mocha.prototype.run.call(mocha,function(){Mocha.utils.highlightTags("code"),fn&&fn()})}}()}();var sinon=function(){"use strict";var buster=function(setTimeout,B){var isNode="function"==typeof require&&"object"==typeof module,div="undefined"!=typeof document&&document.createElement("div"),F=function(){},buster={bind:function(obj,methOrProp){var method="string"==typeof methOrProp?obj[methOrProp]:methOrProp,args=Array.prototype.slice.call(arguments,2);return function(){var allArgs=args.concat(Array.prototype.slice.call(arguments));return method.apply(obj,allArgs)}},partial:function(fn){var args=[].slice.call(arguments,1);return function(){return fn.apply(this,args.concat([].slice.call(arguments)))}},create:function(object){return F.prototype=object,new F},extend:function(target){if(target){for(var prop,i=1,l=arguments.length;l>i;++i)for(prop in arguments[i])target[prop]=arguments[i][prop];return target}},nextTick:function(callback){return"undefined"!=typeof process&&process.nextTick?process.nextTick(callback):void setTimeout(callback,0)},functionName:function(func){if(!func)return"";if(func.displayName)return func.displayName;if(func.name)return func.name;var matches=func.toString().match(/function\s+([^\(]+)/m);return matches&&matches[1]||""},isNode:function(obj){if(!div)return!1;try{obj.appendChild(div),obj.removeChild(div)}catch(e){return!1}return!0},isElement:function(obj){return obj&&1===obj.nodeType&&buster.isNode(obj)},isArray:function(arr){return"[object Array]"==Object.prototype.toString.call(arr)},flatten:function flatten(arr){for(var result=[],arr=arr||[],i=0,l=arr.length;l>i;++i)result=result.concat(buster.isArray(arr[i])?flatten(arr[i]):arr[i]);return result},each:function(arr,callback){for(var i=0,l=arr.length;l>i;++i)callback(arr[i])},map:function(arr,callback){for(var results=[],i=0,l=arr.length;l>i;++i)results.push(callback(arr[i]));return results},parallel:function(fns,callback){function cb(err,res){"function"==typeof callback&&(callback(err,res),callback=null)}function makeDone(num){return function(err,result){return err?cb(err):(results[num]=result,void(0==--remaining&&cb(null,results)))}}if(0==fns.length)return cb(null,[]);for(var remaining=fns.length,results=[],i=0,l=fns.length;l>i;++i)fns[i](makeDone(i))},series:function(fns,callback){function cb(err,res){"function"==typeof callback&&callback(err,res)}function callNext(){if(0==remaining.length)return cb(null,results);var promise=remaining.shift()(next);promise&&"function"==typeof promise.then&&promise.then(buster.partial(next,null),next)}function next(err,result){return err?cb(err):(results.push(result),void callNext())}var remaining=fns.slice(),results=[];callNext()},countdown:function(num,done){return function(){0==--num&&done()}}};if("object"==typeof process&&"function"==typeof require&&"object"==typeof module){var crypto=require("crypto"),path=require("path");buster.tmpFile=function(fileName){var hashed=crypto.createHash("sha1");hashed.update(fileName);var tmpfileName=hashed.digest("hex");return"win32"==process.platform?path.join(process.env.TEMP,tmpfileName):path.join("/tmp",tmpfileName)}}return buster.some=Array.prototype.some?function(arr,fn,thisp){return arr.some(fn,thisp)}:function(arr,fun,thisp){if(null==arr)throw new TypeError;arr=Object(arr);var len=arr.length>>>0;if("function"!=typeof fun)throw new TypeError;for(var i=0;len>i;i++)if(arr.hasOwnProperty(i)&&fun.call(thisp,arr[i],i,arr))return!0;return!1},buster.filter=Array.prototype.filter?function(arr,fn,thisp){return arr.filter(fn,thisp)}:function(fn,thisp){if(null==this)throw new TypeError;var t=Object(this),len=t.length>>>0;if("function"!=typeof fn)throw new TypeError;for(var res=[],i=0;len>i;i++)if(i in t){var val=t[i];fn.call(thisp,val,i,t)&&res.push(val)}return res},isNode&&(module.exports=buster,buster.eventEmitter=require("./buster-event-emitter"),Object.defineProperty(buster,"defineVersionGetter",{get:function(){return require("./define-version-getter")}})),buster.extend(B||{},buster)}(setTimeout,buster);if("undefined"==typeof buster)var buster={};"object"==typeof module&&"function"==typeof require&&(buster=require("buster-core")),buster.format=buster.format||{},buster.format.excludeConstructors=["Object",/^.$/],buster.format.quoteStrings=!0,buster.format.ascii=function(){function keys(object){var k=Object.keys&&Object.keys(object)||[];if(0==k.length)for(var prop in object)hasOwn.call(object,prop)&&k.push(prop);return k.sort()}function isCircular(object,objects){if("object"!=typeof object)return!1;for(var i=0,l=objects.length;l>i;++i)if(objects[i]===object)return!0;return!1}function ascii(object,processed,indent){if("string"==typeof object){var quote="boolean"!=typeof this.quoteStrings||this.quoteStrings;return processed||quote?'"'+object+'"':object}if("function"==typeof object&&!(object instanceof RegExp))return ascii.func(object);if(processed=processed||[],isCircular(object,processed))return"[Circular]";if("[object Array]"==Object.prototype.toString.call(object))return ascii.array.call(this,object,processed);if(!object)return""+object;if(buster.isElement(object))return ascii.element(object);if("function"==typeof object.toString&&object.toString!==Object.prototype.toString)return object.toString();for(var i=0,l=specialObjects.length;l>i;i++)if(object===specialObjects[i].obj)return specialObjects[i].value;return ascii.object.call(this,object,processed,indent)}var hasOwn=Object.prototype.hasOwnProperty,specialObjects=[];return"undefined"!=typeof global&&specialObjects.push({obj:global,value:"[object global]"}),"undefined"!=typeof document&&specialObjects.push({obj:document,value:"[object HTMLDocument]"}),"undefined"!=typeof window&&specialObjects.push({obj:window,value:"[object Window]"}),ascii.func=function(func){return"function "+buster.functionName(func)+"() {}"},ascii.array=function(array,processed){processed=processed||[],processed.push(array);for(var pieces=[],i=0,l=array.length;l>i;++i)pieces.push(ascii.call(this,array[i],processed));return"["+pieces.join(", ")+"]"},ascii.object=function(object,processed,indent){processed=processed||[],processed.push(object),indent=indent||0;for(var prop,str,obj,pieces=[],properties=keys(object),is="",length=3,i=0,l=indent;l>i;++i)is+=" ";for(i=0,l=properties.length;l>i;++i)prop=properties[i],obj=object[prop],str=isCircular(obj,processed)?"[Circular]":ascii.call(this,obj,processed,indent+2),str=(/\s/.test(prop)?'"'+prop+'"':prop)+": "+str,length+=str.length,pieces.push(str);var cons=ascii.constructorName.call(this,object),prefix=cons?"["+cons+"] ":"";return length+indent>80?prefix+"{\n  "+is+pieces.join(",\n  "+is)+"\n"+is+"}":prefix+"{ "+pieces.join(", ")+" }"},ascii.element=function(element){for(var attribute,attrName,tagName=element.tagName.toLowerCase(),attrs=element.attributes,pairs=[],i=0,l=attrs.length;l>i;++i)attribute=attrs.item(i),attrName=attribute.nodeName.toLowerCase().replace("html:",""),("contenteditable"!=attrName||"inherit"!=attribute.nodeValue)&&attribute.nodeValue&&pairs.push(attrName+'="'+attribute.nodeValue+'"');var formatted="<"+tagName+(pairs.length>0?" ":""),content=element.innerHTML;content.length>20&&(content=content.substr(0,20)+"[...]");var res=formatted+pairs.join(" ")+">"+content+"</"+tagName+">";return res.replace(/ contentEditable="inherit"/,"")},ascii.constructorName=function(object){for(var name=buster.functionName(object&&object.constructor),excludes=this.excludeConstructors||buster.format.excludeConstructors||[],i=0,l=excludes.length;l>i;++i){if("string"==typeof excludes[i]&&excludes[i]==name)return"";if(excludes[i].test&&excludes[i].test(name))return""}return name},ascii}(),"undefined"!=typeof module&&(module.exports=buster.format);var sinon=function(buster){function isDOMNode(obj){var success=!1;try{obj.appendChild(div),success=div.parentNode==obj}catch(e){return!1}finally{try{obj.removeChild(div)}catch(e){}}return success}function isElement(obj){return div&&obj&&1===obj.nodeType&&isDOMNode(obj)}function isFunction(obj){return"function"==typeof obj||!!(obj&&obj.constructor&&obj.call&&obj.apply)}function mirrorProperties(target,source){for(var prop in source)hasOwn.call(target,prop)||(target[prop]=source[prop])}var div="undefined"!=typeof document&&document.createElement("div"),hasOwn=Object.prototype.hasOwnProperty,sinon={wrapMethod:function(object,property,method){if(!object)throw new TypeError("Should wrap property of object");if("function"!=typeof method)throw new TypeError("Method wrapper should be function");var wrappedMethod=object[property];if(!isFunction(wrappedMethod))throw new TypeError("Attempted to wrap "+typeof wrappedMethod+" property "+property+" as function");if(wrappedMethod.restore&&wrappedMethod.restore.sinon)throw new TypeError("Attempted to wrap "+property+" which is already wrapped");if(wrappedMethod.calledBefore){var verb=wrappedMethod.returns?"stubbed":"spied on";throw new TypeError("Attempted to wrap "+property+" which is already "+verb)}var owned=hasOwn.call(object,property);return object[property]=method,method.displayName=property,method.restore=function(){owned||delete object[property],object[property]===method&&(object[property]=wrappedMethod)},method.restore.sinon=!0,mirrorProperties(method,wrappedMethod),method},extend:function(target){for(var i=1,l=arguments.length;l>i;i+=1)for(var prop in arguments[i])arguments[i].hasOwnProperty(prop)&&(target[prop]=arguments[i][prop]),arguments[i].hasOwnProperty("toString")&&arguments[i].toString!=target.toString&&(target.toString=arguments[i].toString);return target},create:function(proto){var F=function(){};return F.prototype=proto,new F},deepEqual:function deepEqual(a,b){if(sinon.match&&sinon.match.isMatcher(a))return a.test(b);if("object"!=typeof a||"object"!=typeof b)return a===b;if(isElement(a)||isElement(b))return a===b;if(a===b)return!0;if(null===a&&null!==b||null!==a&&null===b)return!1;var aString=Object.prototype.toString.call(a);if(aString!=Object.prototype.toString.call(b))return!1;if("[object Array]"==aString){if(a.length!==b.length)return!1;for(var i=0,l=a.length;l>i;i+=1)if(!deepEqual(a[i],b[i]))return!1;return!0}var prop,aLength=0,bLength=0;for(prop in a)if(aLength+=1,!deepEqual(a[prop],b[prop]))return!1;for(prop in b)bLength+=1;return aLength!=bLength?!1:!0},functionName:function(func){var name=func.displayName||func.name;if(!name){var matches=func.toString().match(/function ([^\s\(]+)/);name=matches&&matches[1]}return name},functionToString:function(){if(this.getCall&&this.callCount)for(var thisValue,prop,i=this.callCount;i--;){thisValue=this.getCall(i).thisValue;for(prop in thisValue)if(thisValue[prop]===this)return prop}return this.displayName||"sinon fake"},getConfig:function(custom){var config={};custom=custom||{};var defaults=sinon.defaultConfig;for(var prop in defaults)defaults.hasOwnProperty(prop)&&(config[prop]=custom.hasOwnProperty(prop)?custom[prop]:defaults[prop]);return config},format:function(val){return""+val},defaultConfig:{injectIntoThis:!0,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:!0,useFakeServer:!0},timesInWords:function(count){return 1==count&&"once"||2==count&&"twice"||3==count&&"thrice"||(count||0)+" times"},calledInOrder:function(spies){for(var i=1,l=spies.length;l>i;i++)if(!spies[i-1].calledBefore(spies[i])||!spies[i].called)return!1;return!0},orderByFirstCall:function(spies){return spies.sort(function(a,b){var aCall=a.getCall(0),bCall=b.getCall(0),aId=aCall&&aCall.callId||-1,bId=bCall&&bCall.callId||-1;return bId>aId?-1:1})},log:function(){},logError:function(label,err){var msg=label+" threw exception: ";sinon.log(msg+"["+err.name+"] "+err.message),err.stack&&sinon.log(err.stack),setTimeout(function(){throw err.message=msg+err.message,err},0)},typeOf:function(value){if(null===value)return"null";if(void 0===value)return"undefined";var string=Object.prototype.toString.call(value);return string.substring(8,string.length-1).toLowerCase()},createStubInstance:function(constructor){if("function"!=typeof constructor)throw new TypeError("The constructor should be a function.");return sinon.stub(sinon.create(constructor.prototype))}},isNode="object"==typeof module&&"function"==typeof require;if(isNode){try{buster={format:require("buster-format")}}catch(e){}module.exports=sinon,module.exports.spy=require("./sinon/spy"),module.exports.stub=require("./sinon/stub"),module.exports.mock=require("./sinon/mock"),module.exports.collection=require("./sinon/collection"),module.exports.assert=require("./sinon/assert"),module.exports.sandbox=require("./sinon/sandbox"),module.exports.test=require("./sinon/test"),module.exports.testCase=require("./sinon/test_case"),module.exports.assert=require("./sinon/assert"),module.exports.match=require("./sinon/match")}if(buster){var formatter=sinon.create(buster.format);formatter.quoteStrings=!1,sinon.format=function(){return formatter.ascii.apply(formatter,arguments)}}else if(isNode)try{var util=require("util");sinon.format=function(value){return"object"==typeof value&&value.toString===Object.prototype.toString?util.inspect(value):value}}catch(e){}return sinon}("object"==typeof buster&&buster);if(function(sinon){function assertType(value,type,name){var actual=sinon.typeOf(value);if(actual!==type)throw new TypeError("Expected type of "+name+" to be "+type+", but was "+actual)}function isMatcher(object){return matcher.isPrototypeOf(object)}function matchObject(expectation,actual){if(null===actual||void 0===actual)return!1;for(var key in expectation)if(expectation.hasOwnProperty(key)){var exp=expectation[key],act=actual[key];if(match.isMatcher(exp)){if(!exp.test(act))return!1}else if("object"===sinon.typeOf(exp)){if(!matchObject(exp,act))return!1}else if(!sinon.deepEqual(exp,act))return!1}return!0}function createPropertyMatcher(propertyTest,messagePrefix){return function(property,value){assertType(property,"string","property");var onlyProperty=1===arguments.length,message=messagePrefix+'("'+property+'"';return onlyProperty||(message+=", "+value),message+=")",match(function(actual){return void 0!==actual&&null!==actual&&propertyTest(actual,property)?onlyProperty||sinon.deepEqual(value,actual[property]):!1},message)}}var commonJSModule="object"==typeof module&&"function"==typeof require;if(!sinon&&commonJSModule&&(sinon=require("../sinon")),sinon){var matcher={toString:function(){return this.message}};matcher.or=function(m2){if(!isMatcher(m2))throw new TypeError("Matcher expected");var m1=this,or=sinon.create(matcher);return or.test=function(actual){return m1.test(actual)||m2.test(actual)},or.message=m1.message+".or("+m2.message+")",or},matcher.and=function(m2){if(!isMatcher(m2))throw new TypeError("Matcher expected");var m1=this,and=sinon.create(matcher);return and.test=function(actual){return m1.test(actual)&&m2.test(actual)},and.message=m1.message+".and("+m2.message+")",and};var match=function(expectation,message){var m=sinon.create(matcher),type=sinon.typeOf(expectation);switch(type){case"object":if("function"==typeof expectation.test)return m.test=function(actual){return expectation.test(actual)===!0},m.message="match("+sinon.functionName(expectation.test)+")",m;var str=[];for(var key in expectation)expectation.hasOwnProperty(key)&&str.push(key+": "+expectation[key]);m.test=function(actual){return matchObject(expectation,actual)},m.message="match("+str.join(", ")+")";break;case"number":m.test=function(actual){return expectation==actual};break;case"string":m.test=function(actual){return"string"!=typeof actual?!1:-1!==actual.indexOf(expectation)},m.message='match("'+expectation+'")';break;case"regexp":m.test=function(actual){return"string"!=typeof actual?!1:expectation.test(actual)};break;case"function":m.test=expectation,m.message=message?message:"match("+sinon.functionName(expectation)+")";break;default:m.test=function(actual){return sinon.deepEqual(expectation,actual)}}return m.message||(m.message="match("+expectation+")"),m};match.isMatcher=isMatcher,match.any=match(function(){return!0},"any"),match.defined=match(function(actual){return null!==actual&&void 0!==actual},"defined"),match.truthy=match(function(actual){return!!actual},"truthy"),match.falsy=match(function(actual){return!actual},"falsy"),match.same=function(expectation){return match(function(actual){return expectation===actual},"same("+expectation+")")},match.typeOf=function(type){return assertType(type,"string","type"),match(function(actual){return sinon.typeOf(actual)===type},'typeOf("'+type+'")')},match.instanceOf=function(type){return assertType(type,"function","type"),match(function(actual){return actual instanceof type},"instanceOf("+sinon.functionName(type)+")")},match.has=createPropertyMatcher(function(actual,property){return"object"==typeof actual?property in actual:void 0!==actual[property]},"has"),match.hasOwn=createPropertyMatcher(function(actual,property){return actual.hasOwnProperty(property)},"hasOwn"),match.bool=match.typeOf("boolean"),match.number=match.typeOf("number"),match.string=match.typeOf("string"),match.object=match.typeOf("object"),match.func=match.typeOf("function"),match.array=match.typeOf("array"),match.regexp=match.typeOf("regexp"),match.date=match.typeOf("date"),commonJSModule?module.exports=match:sinon.match=match}}("object"==typeof sinon&&sinon||null),function(sinon){function spy(object,property){if(!property&&"function"==typeof object)return spy.create(object);if(!object&&!property)return spy.create(function(){});var method=object[property];return sinon.wrapMethod(object,property,spy.create(method))}var commonJSModule="object"==typeof module&&"function"==typeof require,spyCall,callId=0,push=[].push,slice=Array.prototype.slice;!sinon&&commonJSModule&&(sinon=require("../sinon")),sinon&&(sinon.extend(spy,function(){function delegateToCalls(api,method,matchAny,actual,notCalled){api[method]=function(){if(!this.called)return notCalled?notCalled.apply(this,arguments):!1;for(var currentCall,matches=0,i=0,l=this.callCount;l>i;i+=1)if(currentCall=this.getCall(i),currentCall[actual||method].apply(currentCall,arguments)&&(matches+=1,matchAny))return!0;return matches===this.callCount}}function matchingFake(fakes,args,strict){if(fakes)for(var i=(args.length,0),l=fakes.length;l>i;i++)if(fakes[i].matches(args,strict))return fakes[i]}function incrementCallCount(){this.called=!0,this.callCount+=1,this.notCalled=!1,this.calledOnce=1==this.callCount,this.calledTwice=2==this.callCount,this.calledThrice=3==this.callCount}function createCallProperties(){this.firstCall=this.getCall(0),this.secondCall=this.getCall(1),this.thirdCall=this.getCall(2),this.lastCall=this.getCall(this.callCount-1)}function createProxy(func){var p;return func.length?eval("p = (function proxy("+vars.substring(0,2*func.length-1)+") { return p.invoke(func, this, slice.call(arguments)); });"):p=function(){return p.invoke(func,this,slice.call(arguments))},p}var vars="a,b,c,d,e,f,g,h,i,j,k,l",uuid=0,spyApi={reset:function(){if(this.called=!1,this.notCalled=!0,this.calledOnce=!1,this.calledTwice=!1,this.calledThrice=!1,this.callCount=0,this.firstCall=null,this.secondCall=null,this.thirdCall=null,this.lastCall=null,this.args=[],this.returnValues=[],this.thisValues=[],this.exceptions=[],this.callIds=[],this.fakes)for(var i=0;i<this.fakes.length;i++)this.fakes[i].reset()},create:function(func){var name;"function"!=typeof func?func=function(){}:name=sinon.functionName(func);var proxy=createProxy(func);return sinon.extend(proxy,spy),delete proxy.create,sinon.extend(proxy,func),proxy.reset(),proxy.prototype=func.prototype,proxy.displayName=name||"spy",proxy.toString=sinon.functionToString,proxy._create=sinon.spy.create,proxy.id="spy#"+uuid++,proxy},invoke:function(func,thisValue,args){var exception,returnValue,matching=matchingFake(this.fakes,args);incrementCallCount.call(this),push.call(this.thisValues,thisValue),push.call(this.args,args),push.call(this.callIds,callId++);try{returnValue=matching?matching.invoke(func,thisValue,args):(this.func||func).apply(thisValue,args)}catch(e){throw push.call(this.returnValues,void 0),exception=e,e}finally{push.call(this.exceptions,exception)}return push.call(this.returnValues,returnValue),createCallProperties.call(this),returnValue},getCall:function(i){return 0>i||i>=this.callCount?null:spyCall.create(this,this.thisValues[i],this.args[i],this.returnValues[i],this.exceptions[i],this.callIds[i])},calledBefore:function(spyFn){return this.called?spyFn.called?this.callIds[0]<spyFn.callIds[spyFn.callIds.length-1]:!0:!1},calledAfter:function(spyFn){return this.called&&spyFn.called?this.callIds[this.callCount-1]>spyFn.callIds[spyFn.callCount-1]:!1},withArgs:function(){var args=slice.call(arguments);if(this.fakes){var match=matchingFake(this.fakes,args,!0);if(match)return match}else this.fakes=[];var original=this,fake=this._create();fake.matchingAguments=args,push.call(this.fakes,fake),fake.withArgs=function(){return original.withArgs.apply(original,arguments)};for(var i=0;i<this.args.length;i++)fake.matches(this.args[i])&&(incrementCallCount.call(fake),push.call(fake.thisValues,this.thisValues[i]),push.call(fake.args,this.args[i]),push.call(fake.returnValues,this.returnValues[i]),push.call(fake.exceptions,this.exceptions[i]),push.call(fake.callIds,this.callIds[i]));return createCallProperties.call(fake),fake},matches:function(args,strict){var margs=this.matchingAguments;return margs.length<=args.length&&sinon.deepEqual(margs,args.slice(0,margs.length))?!strict||margs.length==args.length:void 0},printf:function(format){var formatter,spy=this,args=slice.call(arguments,1);return(format||"").replace(/%(.)/g,function(match,specifyer){return formatter=spyApi.formatters[specifyer],"function"==typeof formatter?formatter.call(null,spy,args):isNaN(parseInt(specifyer),10)?"%"+specifyer:sinon.format(args[specifyer-1])})}};return delegateToCalls(spyApi,"calledOn",!0),delegateToCalls(spyApi,"alwaysCalledOn",!1,"calledOn"),delegateToCalls(spyApi,"calledWith",!0),delegateToCalls(spyApi,"calledWithMatch",!0),delegateToCalls(spyApi,"alwaysCalledWith",!1,"calledWith"),delegateToCalls(spyApi,"alwaysCalledWithMatch",!1,"calledWithMatch"),delegateToCalls(spyApi,"calledWithExactly",!0),delegateToCalls(spyApi,"alwaysCalledWithExactly",!1,"calledWithExactly"),delegateToCalls(spyApi,"neverCalledWith",!1,"notCalledWith",function(){return!0}),delegateToCalls(spyApi,"neverCalledWithMatch",!1,"notCalledWithMatch",function(){return!0}),delegateToCalls(spyApi,"threw",!0),delegateToCalls(spyApi,"alwaysThrew",!1,"threw"),delegateToCalls(spyApi,"returned",!0),delegateToCalls(spyApi,"alwaysReturned",!1,"returned"),delegateToCalls(spyApi,"calledWithNew",!0),delegateToCalls(spyApi,"alwaysCalledWithNew",!1,"calledWithNew"),delegateToCalls(spyApi,"callArg",!1,"callArgWith",function(){throw new Error(this.toString()+" cannot call arg since it was not yet invoked.")}),spyApi.callArgWith=spyApi.callArg,delegateToCalls(spyApi,"callArgOn",!1,"callArgOnWith",function(){throw new Error(this.toString()+" cannot call arg since it was not yet invoked.")}),spyApi.callArgOnWith=spyApi.callArgOn,delegateToCalls(spyApi,"yield",!1,"yield",function(){throw new Error(this.toString()+" cannot yield since it was not yet invoked.")}),spyApi.invokeCallback=spyApi.yield,delegateToCalls(spyApi,"yieldOn",!1,"yieldOn",function(){throw new Error(this.toString()+" cannot yield since it was not yet invoked.")}),delegateToCalls(spyApi,"yieldTo",!1,"yieldTo",function(property){throw new Error(this.toString()+" cannot yield to '"+property+"' since it was not yet invoked.")}),delegateToCalls(spyApi,"yieldToOn",!1,"yieldToOn",function(property){throw new Error(this.toString()+" cannot yield to '"+property+"' since it was not yet invoked.")}),spyApi.formatters={c:function(spy){return sinon.timesInWords(spy.callCount)},n:function(spy){return spy.toString()},C:function(spy){for(var calls=[],i=0,l=spy.callCount;l>i;++i){var stringifiedCall="    "+spy.getCall(i).toString();/\n/.test(calls[i-1])&&(stringifiedCall="\n"+stringifiedCall),push.call(calls,stringifiedCall)}return calls.length>0?"\n"+calls.join("\n"):""},t:function(spy){for(var objects=[],i=0,l=spy.callCount;l>i;++i)push.call(objects,sinon.format(spy.thisValues[i]));return objects.join(", ")},"*":function(spy,args){for(var formatted=[],i=0,l=args.length;l>i;++i)push.call(formatted,sinon.format(args[i]));return formatted.join(", ")}},spyApi}()),spyCall=function(){function throwYieldError(proxy,text,args){var msg=sinon.functionName(proxy)+text;throw args.length&&(msg+=" Received ["+slice.call(args).join(", ")+"]"),new Error(msg)}var callApi={create:function(spy,thisValue,args,returnValue,exception,id){var proxyCall=sinon.create(spyCall);return delete proxyCall.create,proxyCall.proxy=spy,proxyCall.thisValue=thisValue,proxyCall.args=args,proxyCall.returnValue=returnValue,proxyCall.exception=exception,proxyCall.callId="number"==typeof id&&id||callId++,proxyCall},calledOn:function(thisValue){return sinon.match&&sinon.match.isMatcher(thisValue)?thisValue.test(this.thisValue):this.thisValue===thisValue},calledWith:function(){for(var i=0,l=arguments.length;l>i;i+=1)if(!sinon.deepEqual(arguments[i],this.args[i]))return!1;return!0},calledWithMatch:function(){for(var i=0,l=arguments.length;l>i;i+=1){var actual=this.args[i],expectation=arguments[i];if(!sinon.match||!sinon.match(expectation).test(actual))return!1}return!0},calledWithExactly:function(){return arguments.length==this.args.length&&this.calledWith.apply(this,arguments)},notCalledWith:function(){return!this.calledWith.apply(this,arguments)},notCalledWithMatch:function(){return!this.calledWithMatch.apply(this,arguments)},returned:function(value){return sinon.deepEqual(value,this.returnValue)},threw:function(error){return"undefined"!=typeof error&&this.exception?"string"==typeof error?this.exception.name==error:this.exception===error:!!this.exception},calledWithNew:function(){return this.thisValue instanceof this.proxy},calledBefore:function(other){return this.callId<other.callId},calledAfter:function(other){return this.callId>other.callId},callArg:function(pos){this.args[pos]()},callArgOn:function(pos,thisValue){this.args[pos].apply(thisValue)},callArgWith:function(pos){this.callArgOnWith.apply(this,[pos,null].concat(slice.call(arguments,1)))},callArgOnWith:function(pos,thisValue){var args=slice.call(arguments,2);this.args[pos].apply(thisValue,args)},"yield":function(){this.yieldOn.apply(this,[null].concat(slice.call(arguments,0)))},yieldOn:function(thisValue){for(var args=this.args,i=0,l=args.length;l>i;++i)if("function"==typeof args[i])return void args[i].apply(thisValue,slice.call(arguments,1));throwYieldError(this.proxy," cannot yield since no callback was passed.",args)},yieldTo:function(prop){this.yieldToOn.apply(this,[prop,null].concat(slice.call(arguments,1)))},yieldToOn:function(prop,thisValue){for(var args=this.args,i=0,l=args.length;l>i;++i)if(args[i]&&"function"==typeof args[i][prop])return void args[i][prop].apply(thisValue,slice.call(arguments,2));throwYieldError(this.proxy," cannot yield to '"+prop+"' since no callback was passed.",args)},toString:function(){for(var callStr=this.proxy.toString()+"(",args=[],i=0,l=this.args.length;l>i;++i)push.call(args,sinon.format(this.args[i]));return callStr=callStr+args.join(", ")+")","undefined"!=typeof this.returnValue&&(callStr+=" => "+sinon.format(this.returnValue)),this.exception&&(callStr+=" !"+this.exception.name,this.exception.message&&(callStr+="("+this.exception.message+")")),callStr}};return callApi.invokeCallback=callApi.yield,callApi}(),spy.spyCall=spyCall,sinon.spyCall=spyCall,commonJSModule?module.exports=spy:sinon.spy=spy)}("object"==typeof sinon&&sinon||null),function(sinon){function stub(object,property,func){if(func&&"function"!=typeof func)throw new TypeError("Custom stub should be function");var wrapper;if(wrapper=func?sinon.spy&&sinon.spy.create?sinon.spy.create(func):func:stub.create(),!object&&!property)return sinon.stub.create();if(!property&&object&&"object"==typeof object){for(var prop in object)"function"==typeof object[prop]&&stub(object,prop);
return object}return sinon.wrapMethod(object,property,wrapper)}function getChangingValue(stub,property){var index=stub.callCount-1,values=stub[property],prop=index in values?values[index]:values[values.length-1];return stub[property+"Last"]=prop,prop}function getCallback(stub,args){var callArgAt=getChangingValue(stub,"callArgAts");if(0>callArgAt){for(var callArgProp=getChangingValue(stub,"callArgProps"),i=0,l=args.length;l>i;++i){if(!callArgProp&&"function"==typeof args[i])return args[i];if(callArgProp&&args[i]&&"function"==typeof args[i][callArgProp])return args[i][callArgProp]}return null}return args[callArgAt]}function getCallbackError(stub,func,args){if(stub.callArgAtsLast<0){var msg;return msg=stub.callArgPropsLast?sinon.functionName(stub)+" expected to yield to '"+stub.callArgPropsLast+"', but no object with such a property was passed.":sinon.functionName(stub)+" expected to yield, but no callback was passed.",args.length>0&&(msg+=" Received ["+join.call(args,", ")+"]"),msg}return"argument at index "+stub.callArgAtsLast+" is not a function: "+func}function callCallback(stub,args){if(stub.callArgAts.length>0){var func=getCallback(stub,args);if("function"!=typeof func)throw new TypeError(getCallbackError(stub,func,args));var callbackArguments=getChangingValue(stub,"callbackArguments"),callbackContext=getChangingValue(stub,"callbackContexts");stub.callbackAsync?nextTick(function(){func.apply(callbackContext,callbackArguments)}):func.apply(callbackContext,callbackArguments)}}var commonJSModule="object"==typeof module&&"function"==typeof require;if(!sinon&&commonJSModule&&(sinon=require("../sinon")),sinon){var join=Array.prototype.join,nextTick=function(){return"object"==typeof process&&"function"==typeof process.nextTick?process.nextTick:"function"==typeof setImmediate?setImmediate:function(callback){setTimeout(callback,0)}}(),uuid=0;sinon.extend(stub,function(){function throwsException(error,message){return"string"==typeof error?(this.exception=new Error(message||""),this.exception.name=error):this.exception=error?error:new Error("Error"),this}var proto,slice=Array.prototype.slice;proto={create:function(){var functionStub=function(){if(callCallback(functionStub,arguments),functionStub.exception)throw functionStub.exception;return"number"==typeof functionStub.returnArgAt?arguments[functionStub.returnArgAt]:functionStub.returnThis?this:functionStub.returnValue};functionStub.id="stub#"+uuid++;var orig=functionStub;return functionStub=sinon.spy.create(functionStub),functionStub.func=orig,functionStub.callArgAts=[],functionStub.callbackArguments=[],functionStub.callbackContexts=[],functionStub.callArgProps=[],sinon.extend(functionStub,stub),functionStub._create=sinon.stub.create,functionStub.displayName="stub",functionStub.toString=sinon.functionToString,functionStub},resetBehavior:function(){var i;if(this.callArgAts=[],this.callbackArguments=[],this.callbackContexts=[],this.callArgProps=[],delete this.returnValue,delete this.returnArgAt,this.returnThis=!1,this.fakes)for(i=0;i<this.fakes.length;i++)this.fakes[i].resetBehavior()},returns:function(value){return this.returnValue=value,this},returnsArg:function(pos){if("number"!=typeof pos)throw new TypeError("argument index is not number");return this.returnArgAt=pos,this},returnsThis:function(){return this.returnThis=!0,this},"throws":throwsException,throwsException:throwsException,callsArg:function(pos){if("number"!=typeof pos)throw new TypeError("argument index is not number");return this.callArgAts.push(pos),this.callbackArguments.push([]),this.callbackContexts.push(void 0),this.callArgProps.push(void 0),this},callsArgOn:function(pos,context){if("number"!=typeof pos)throw new TypeError("argument index is not number");if("object"!=typeof context)throw new TypeError("argument context is not an object");return this.callArgAts.push(pos),this.callbackArguments.push([]),this.callbackContexts.push(context),this.callArgProps.push(void 0),this},callsArgWith:function(pos){if("number"!=typeof pos)throw new TypeError("argument index is not number");return this.callArgAts.push(pos),this.callbackArguments.push(slice.call(arguments,1)),this.callbackContexts.push(void 0),this.callArgProps.push(void 0),this},callsArgOnWith:function(pos,context){if("number"!=typeof pos)throw new TypeError("argument index is not number");if("object"!=typeof context)throw new TypeError("argument context is not an object");return this.callArgAts.push(pos),this.callbackArguments.push(slice.call(arguments,2)),this.callbackContexts.push(context),this.callArgProps.push(void 0),this},yields:function(){return this.callArgAts.push(-1),this.callbackArguments.push(slice.call(arguments,0)),this.callbackContexts.push(void 0),this.callArgProps.push(void 0),this},yieldsOn:function(context){if("object"!=typeof context)throw new TypeError("argument context is not an object");return this.callArgAts.push(-1),this.callbackArguments.push(slice.call(arguments,1)),this.callbackContexts.push(context),this.callArgProps.push(void 0),this},yieldsTo:function(prop){return this.callArgAts.push(-1),this.callbackArguments.push(slice.call(arguments,1)),this.callbackContexts.push(void 0),this.callArgProps.push(prop),this},yieldsToOn:function(prop,context){if("object"!=typeof context)throw new TypeError("argument context is not an object");return this.callArgAts.push(-1),this.callbackArguments.push(slice.call(arguments,2)),this.callbackContexts.push(context),this.callArgProps.push(prop),this}};for(var method in proto)proto.hasOwnProperty(method)&&method.match(/^(callsArg|yields|thenYields$)/)&&!method.match(/Async/)&&(proto[method+"Async"]=function(syncFnName){return function(){return this.callbackAsync=!0,this[syncFnName].apply(this,arguments)}}(method));return proto}()),commonJSModule?module.exports=stub:sinon.stub=stub}}("object"==typeof sinon&&sinon||null),function(sinon){function mock(object){return object?mock.create(object):sinon.expectation.create("Anonymous mock")}var commonJSModule="object"==typeof module&&"function"==typeof require,push=[].push;if(!sinon&&commonJSModule&&(sinon=require("../sinon")),sinon){sinon.mock=mock,sinon.extend(mock,function(){function each(collection,callback){if(collection)for(var i=0,l=collection.length;l>i;i+=1)callback(collection[i])}return{create:function(object){if(!object)throw new TypeError("object is null");var mockObject=sinon.extend({},mock);return mockObject.object=object,delete mockObject.create,mockObject},expects:function(method){if(!method)throw new TypeError("method is falsy");if(this.expectations||(this.expectations={},this.proxies=[]),!this.expectations[method]){this.expectations[method]=[];var mockObject=this;sinon.wrapMethod(this.object,method,function(){return mockObject.invokeMethod(method,this,arguments)}),push.call(this.proxies,method)}var expectation=sinon.expectation.create(method);return push.call(this.expectations[method],expectation),expectation},restore:function(){var object=this.object;each(this.proxies,function(proxy){"function"==typeof object[proxy].restore&&object[proxy].restore()})},verify:function(){var expectations=this.expectations||{},messages=[],met=[];return each(this.proxies,function(proxy){each(expectations[proxy],function(expectation){expectation.met()?push.call(met,expectation.toString()):push.call(messages,expectation.toString())})}),this.restore(),messages.length>0?sinon.expectation.fail(messages.concat(met).join("\n")):sinon.expectation.pass(messages.concat(met).join("\n")),!0},invokeMethod:function(method,thisValue,args){var i,expectations=this.expectations&&this.expectations[method],length=expectations&&expectations.length||0;for(i=0;length>i;i+=1)if(!expectations[i].met()&&expectations[i].allowsCall(thisValue,args))return expectations[i].apply(thisValue,args);var available,messages=[],exhausted=0;for(i=0;length>i;i+=1)expectations[i].allowsCall(thisValue,args)?available=available||expectations[i]:exhausted+=1,push.call(messages,"    "+expectations[i].toString());return 0===exhausted?available.apply(thisValue,args):(messages.unshift("Unexpected call: "+sinon.spyCall.toString.call({proxy:method,args:args})),void sinon.expectation.fail(messages.join("\n")))}}}());var times=sinon.timesInWords;sinon.expectation=function(){function callCountInWords(callCount){return 0==callCount?"never called":"called "+times(callCount)}function expectedCallCountInWords(expectation){var min=expectation.minCalls,max=expectation.maxCalls;if("number"==typeof min&&"number"==typeof max){var str=times(min);return min!=max&&(str="at least "+str+" and at most "+times(max)),str}return"number"==typeof min?"at least "+times(min):"at most "+times(max)}function receivedMinCalls(expectation){var hasMinLimit="number"==typeof expectation.minCalls;return!hasMinLimit||expectation.callCount>=expectation.minCalls}function receivedMaxCalls(expectation){return"number"!=typeof expectation.maxCalls?!1:expectation.callCount==expectation.maxCalls}var slice=Array.prototype.slice,_invoke=sinon.spy.invoke;return{minCalls:1,maxCalls:1,create:function(methodName){var expectation=sinon.extend(sinon.stub.create(),sinon.expectation);return delete expectation.create,expectation.method=methodName,expectation},invoke:function(func,thisValue,args){return this.verifyCallAllowed(thisValue,args),_invoke.apply(this,arguments)},atLeast:function(num){if("number"!=typeof num)throw new TypeError("'"+num+"' is not number");return this.limitsSet||(this.maxCalls=null,this.limitsSet=!0),this.minCalls=num,this},atMost:function(num){if("number"!=typeof num)throw new TypeError("'"+num+"' is not number");return this.limitsSet||(this.minCalls=null,this.limitsSet=!0),this.maxCalls=num,this},never:function(){return this.exactly(0)},once:function(){return this.exactly(1)},twice:function(){return this.exactly(2)},thrice:function(){return this.exactly(3)},exactly:function(num){if("number"!=typeof num)throw new TypeError("'"+num+"' is not a number");return this.atLeast(num),this.atMost(num)},met:function(){return!this.failed&&receivedMinCalls(this)},verifyCallAllowed:function(thisValue,args){if(receivedMaxCalls(this)&&(this.failed=!0,sinon.expectation.fail(this.method+" already called "+times(this.maxCalls))),"expectedThis"in this&&this.expectedThis!==thisValue&&sinon.expectation.fail(this.method+" called with "+thisValue+" as thisValue, expected "+this.expectedThis),"expectedArguments"in this){args||sinon.expectation.fail(this.method+" received no arguments, expected "+sinon.format(this.expectedArguments)),args.length<this.expectedArguments.length&&sinon.expectation.fail(this.method+" received too few arguments ("+sinon.format(args)+"), expected "+sinon.format(this.expectedArguments)),this.expectsExactArgCount&&args.length!=this.expectedArguments.length&&sinon.expectation.fail(this.method+" received too many arguments ("+sinon.format(args)+"), expected "+sinon.format(this.expectedArguments));for(var i=0,l=this.expectedArguments.length;l>i;i+=1)sinon.deepEqual(this.expectedArguments[i],args[i])||sinon.expectation.fail(this.method+" received wrong arguments "+sinon.format(args)+", expected "+sinon.format(this.expectedArguments))}},allowsCall:function(thisValue,args){if(this.met()&&receivedMaxCalls(this))return!1;if("expectedThis"in this&&this.expectedThis!==thisValue)return!1;if(!("expectedArguments"in this))return!0;if(args=args||[],args.length<this.expectedArguments.length)return!1;if(this.expectsExactArgCount&&args.length!=this.expectedArguments.length)return!1;for(var i=0,l=this.expectedArguments.length;l>i;i+=1)if(!sinon.deepEqual(this.expectedArguments[i],args[i]))return!1;return!0},withArgs:function(){return this.expectedArguments=slice.call(arguments),this},withExactArgs:function(){return this.withArgs.apply(this,arguments),this.expectsExactArgCount=!0,this},on:function(thisValue){return this.expectedThis=thisValue,this},toString:function(){var args=(this.expectedArguments||[]).slice();this.expectsExactArgCount||push.call(args,"[...]");var callStr=sinon.spyCall.toString.call({proxy:this.method||"anonymous mock expectation",args:args}),message=callStr.replace(", [...","[, ...")+" "+expectedCallCountInWords(this);return this.met()?"Expectation met: "+message:"Expected "+message+" ("+callCountInWords(this.callCount)+")"},verify:function(){return this.met()?sinon.expectation.pass(this.toString()):sinon.expectation.fail(this.toString()),!0},pass:function(message){sinon.assert.pass(message)},fail:function(message){var exception=new Error(message);throw exception.name="ExpectationError",exception}}}(),commonJSModule?module.exports=mock:sinon.mock=mock}}("object"==typeof sinon&&sinon||null),function(sinon){function getFakes(fakeCollection){return fakeCollection.fakes||(fakeCollection.fakes=[]),fakeCollection.fakes}function each(fakeCollection,method){for(var fakes=getFakes(fakeCollection),i=0,l=fakes.length;l>i;i+=1)"function"==typeof fakes[i][method]&&fakes[i][method]()}function compact(fakeCollection){for(var fakes=getFakes(fakeCollection),i=0;i<fakes.length;)fakes.splice(i,1)}var commonJSModule="object"==typeof module&&"function"==typeof require,push=[].push,hasOwnProperty=Object.prototype.hasOwnProperty;if(!sinon&&commonJSModule&&(sinon=require("../sinon")),sinon){var collection={verify:function(){each(this,"verify")},restore:function(){each(this,"restore"),compact(this)},verifyAndRestore:function(){var exception;try{this.verify()}catch(e){exception=e}if(this.restore(),exception)throw exception},add:function(fake){return push.call(getFakes(this),fake),fake},spy:function(){return this.add(sinon.spy.apply(sinon,arguments))},stub:function(object,property,value){if(property){var original=object[property];if("function"!=typeof original){if(!hasOwnProperty.call(object,property))throw new TypeError("Cannot stub non-existent own property "+property);return object[property]=value,this.add({restore:function(){object[property]=original}})}}if(!property&&object&&"object"==typeof object){var stubbedObj=sinon.stub.apply(sinon,arguments);for(var prop in stubbedObj)"function"==typeof stubbedObj[prop]&&this.add(stubbedObj[prop]);return stubbedObj}return this.add(sinon.stub.apply(sinon,arguments))},mock:function(){return this.add(sinon.mock.apply(sinon,arguments))},inject:function(obj){var col=this;return obj.spy=function(){return col.spy.apply(col,arguments)},obj.stub=function(){return col.stub.apply(col,arguments)},obj.mock=function(){return col.mock.apply(col,arguments)},obj}};commonJSModule?module.exports=collection:sinon.collection=collection}}("object"==typeof sinon&&sinon||null),"undefined"==typeof sinon)var sinon={};if(function(global){function addTimer(args,recurring){if(0===args.length)throw new Error("Function requires at least 1 parameter");var toId=id++,delay=args[1]||0;return this.timeouts||(this.timeouts={}),this.timeouts[toId]={id:toId,func:args[0],callAt:this.now+delay,invokeArgs:Array.prototype.slice.call(args,2)},recurring===!0&&(this.timeouts[toId].interval=delay),toId}function parseTime(str){if(!str)return 0;var parsed,strings=str.split(":"),l=strings.length,i=l,ms=0;if(l>3||!/^(\d\d:){0,2}\d\d?$/.test(str))throw new Error("tick only understands numbers and 'h:m:s'");for(;i--;){if(parsed=parseInt(strings[i],10),parsed>=60)throw new Error("Invalid time "+str);ms+=parsed*Math.pow(60,l-i-1)}return 1e3*ms}function createObject(object){var newObject;if(Object.create)newObject=Object.create(object);else{var F=function(){};F.prototype=object,newObject=new F}return newObject.Date.clock=newObject,newObject}function mirrorDateProperties(target,source){return source.now?target.now=function(){return target.clock.now}:delete target.now,source.toSource?target.toSource=function(){return source.toSource()}:delete target.toSource,target.toString=function(){return source.toString()},target.prototype=source.prototype,target.parse=source.parse,target.UTC=source.UTC,target.prototype.toUTCString=source.prototype.toUTCString,target}function restore(){for(var method,i=0,l=this.methods.length;l>i;i++)method=this.methods[i],global[method].hadOwnProperty?global[method]=this["_"+method]:delete global[method];this.methods=[]}function stubGlobal(method,clock){if(clock[method].hadOwnProperty=Object.prototype.hasOwnProperty.call(global,method),clock["_"+method]=global[method],"Date"==method){var date=mirrorDateProperties(clock[method],global[method]);global[method]=date}else{global[method]=function(){return clock[method].apply(clock,arguments)};for(var prop in clock[method])clock[method].hasOwnProperty(prop)&&(global[method][prop]=clock[method][prop])}global[method].clock=clock}var id=1;sinon.clock={now:0,create:function(now){var clock=createObject(this);if("number"==typeof now&&(clock.now=now),now&&"object"==typeof now)throw new TypeError("now should be milliseconds since UNIX epoch");return clock},setTimeout:function(){return addTimer.call(this,arguments,!1)},clearTimeout:function(timerId){this.timeouts||(this.timeouts=[]),timerId in this.timeouts&&delete this.timeouts[timerId]},setInterval:function(){return addTimer.call(this,arguments,!0)},clearInterval:function(timerId){this.clearTimeout(timerId)},tick:function(ms){ms="number"==typeof ms?ms:parseTime(ms);for(var firstException,tickFrom=this.now,tickTo=this.now+ms,previous=this.now,timer=this.firstTimerInRange(tickFrom,tickTo);timer&&tickTo>=tickFrom;){if(this.timeouts[timer.id]){tickFrom=this.now=timer.callAt;try{this.callTimer(timer)}catch(e){firstException=firstException||e}}timer=this.firstTimerInRange(previous,tickTo),previous=tickFrom}if(this.now=tickTo,firstException)throw firstException;return this.now},firstTimerInRange:function(from,to){var timer,smallest,originalTimer;for(var id in this.timeouts)if(this.timeouts.hasOwnProperty(id)){if(this.timeouts[id].callAt<from||this.timeouts[id].callAt>to)continue;(!smallest||this.timeouts[id].callAt<smallest)&&(originalTimer=this.timeouts[id],smallest=this.timeouts[id].callAt,timer={func:this.timeouts[id].func,callAt:this.timeouts[id].callAt,interval:this.timeouts[id].interval,id:this.timeouts[id].id,invokeArgs:this.timeouts[id].invokeArgs})}return timer||null},callTimer:function(timer){"number"==typeof timer.interval?this.timeouts[timer.id].callAt+=timer.interval:delete this.timeouts[timer.id];try{"function"==typeof timer.func?timer.func.apply(null,timer.invokeArgs):eval(timer.func)}catch(e){var exception=e}if(this.timeouts[timer.id]){if(exception)throw exception}else if(exception)throw exception},reset:function(){this.timeouts={}},Date:function(){function ClockDate(year,month,date,hour,minute,second,ms){switch(arguments.length){case 0:return new NativeDate(ClockDate.clock.now);case 1:return new NativeDate(year);case 2:return new NativeDate(year,month);case 3:return new NativeDate(year,month,date);case 4:return new NativeDate(year,month,date,hour);case 5:return new NativeDate(year,month,date,hour,minute);case 6:return new NativeDate(year,month,date,hour,minute,second);default:return new NativeDate(year,month,date,hour,minute,second,ms)}}var NativeDate=Date;return mirrorDateProperties(ClockDate,NativeDate)}()};var methods=["Date","setTimeout","setInterval","clearTimeout","clearInterval"];sinon.useFakeTimers=function(now){var clock=sinon.clock.create(now);clock.restore=restore,clock.methods=Array.prototype.slice.call(arguments,"number"==typeof now?1:0),0===clock.methods.length&&(clock.methods=methods);for(var i=0,l=clock.methods.length;l>i;i++)stubGlobal(clock.methods[i],clock);return clock}}("undefined"!=typeof global&&"function"!=typeof global?global:this),sinon.timers={setTimeout:setTimeout,clearTimeout:clearTimeout,setInterval:setInterval,clearInterval:clearInterval,Date:Date},"object"==typeof module&&"function"==typeof require&&(module.exports=sinon),"undefined"==typeof sinon&&(this.sinon={}),function(){var push=[].push;sinon.Event=function(type,bubbles,cancelable){this.initEvent(type,bubbles,cancelable)},sinon.Event.prototype={initEvent:function(type,bubbles,cancelable){this.type=type,this.bubbles=bubbles,this.cancelable=cancelable},stopPropagation:function(){},preventDefault:function(){this.defaultPrevented=!0}},sinon.EventTarget={addEventListener:function(event,listener){this.eventListeners=this.eventListeners||{},this.eventListeners[event]=this.eventListeners[event]||[],push.call(this.eventListeners[event],listener)},removeEventListener:function(event,listener){for(var listeners=this.eventListeners&&this.eventListeners[event]||[],i=0,l=listeners.length;l>i;++i)if(listeners[i]==listener)return listeners.splice(i,1)},dispatchEvent:function(event){for(var type=event.type,listeners=this.eventListeners&&this.eventListeners[type]||[],i=0;i<listeners.length;i++)"function"==typeof listeners[i]?listeners[i].call(this,event):listeners[i].handleEvent(event);return!!event.defaultPrevented}}}(),"undefined"==typeof sinon&&(this.sinon={}),sinon.xhr={XMLHttpRequest:this.XMLHttpRequest},function(global){function FakeXMLHttpRequest(){this.readyState=FakeXMLHttpRequest.UNSENT,this.requestHeaders={},this.requestBody=null,this.status=0,this.statusText="","function"==typeof FakeXMLHttpRequest.onCreate&&FakeXMLHttpRequest.onCreate(this)}function verifyState(xhr){if(xhr.readyState!==FakeXMLHttpRequest.OPENED)throw new Error("INVALID_STATE_ERR");if(xhr.sendFlag)throw new Error("INVALID_STATE_ERR")}function each(collection,callback){if(collection)for(var i=0,l=collection.length;l>i;i+=1)callback(collection[i])}function some(collection,callback){for(var index=0;index<collection.length;index++)if(callback(collection[index])===!0)return!0;return!1}function verifyRequestSent(xhr){if(xhr.readyState==FakeXMLHttpRequest.DONE)throw new Error("Request done")}function verifyHeadersReceived(xhr){if(xhr.async&&xhr.readyState!=FakeXMLHttpRequest.HEADERS_RECEIVED)throw new Error("No headers received")}function verifyResponseBodyType(body){if("string"!=typeof body){var error=new Error("Attempted to respond to fake XMLHttpRequest with "+body+", which is not a string.");throw error.name="InvalidBodyException",error}}var xhr=sinon.xhr;xhr.GlobalXMLHttpRequest=global.XMLHttpRequest,xhr.GlobalActiveXObject=global.ActiveXObject,xhr.supportsActiveX="undefined"!=typeof xhr.GlobalActiveXObject,xhr.supportsXHR="undefined"!=typeof xhr.GlobalXMLHttpRequest,xhr.workingXHR=xhr.supportsXHR?xhr.GlobalXMLHttpRequest:xhr.supportsActiveX?function(){return new xhr.GlobalActiveXObject("MSXML2.XMLHTTP.3.0")}:!1;var unsafeHeaders={"Accept-Charset":!0,"Accept-Encoding":!0,Connection:!0,"Content-Length":!0,Cookie:!0,Cookie2:!0,"Content-Transfer-Encoding":!0,Date:!0,Expect:!0,Host:!0,"Keep-Alive":!0,Referer:!0,TE:!0,Trailer:!0,"Transfer-Encoding":!0,Upgrade:!0,"User-Agent":!0,Via:!0},apply=function(obj,method,args){switch(args.length){case 0:return obj[method]();case 1:return obj[method](args[0]);case 2:return obj[method](args[0],args[1]);case 3:return obj[method](args[0],args[1],args[2]);case 4:return obj[method](args[0],args[1],args[2],args[3]);case 5:return obj[method](args[0],args[1],args[2],args[3],args[4])}};FakeXMLHttpRequest.filters=[],FakeXMLHttpRequest.addFilter=function(fn){this.filters.push(fn)};var IE6Re=/MSIE 6/;FakeXMLHttpRequest.defake=function(fakeXhr,xhrArgs){var xhr=new sinon.xhr.workingXHR;each(["open","setRequestHeader","send","abort","getResponseHeader","getAllResponseHeaders","addEventListener","overrideMimeType","removeEventListener"],function(method){fakeXhr[method]=function(){return apply(xhr,method,arguments)}});var copyAttrs=function(args){each(args,function(attr){try{fakeXhr[attr]=xhr[attr]}catch(e){if(!IE6Re.test(navigator.userAgent))throw e}})},stateChange=function(){fakeXhr.readyState=xhr.readyState,xhr.readyState>=FakeXMLHttpRequest.HEADERS_RECEIVED&&copyAttrs(["status","statusText"]),xhr.readyState>=FakeXMLHttpRequest.LOADING&&copyAttrs(["responseText"]),xhr.readyState===FakeXMLHttpRequest.DONE&&copyAttrs(["responseXML"]),fakeXhr.onreadystatechange&&fakeXhr.onreadystatechange.call(fakeXhr)};if(xhr.addEventListener){for(var event in fakeXhr.eventListeners)fakeXhr.eventListeners.hasOwnProperty(event)&&each(fakeXhr.eventListeners[event],function(handler){xhr.addEventListener(event,handler)});xhr.addEventListener("readystatechange",stateChange)}else xhr.onreadystatechange=stateChange;apply(xhr,"open",xhrArgs)},FakeXMLHttpRequest.useFilters=!1,sinon.extend(FakeXMLHttpRequest.prototype,sinon.EventTarget,{async:!0,open:function(method,url,async,username,password){if(this.method=method,this.url=url,this.async="boolean"==typeof async?async:!0,this.username=username,this.password=password,this.responseText=null,this.responseXML=null,this.requestHeaders={},this.sendFlag=!1,sinon.FakeXMLHttpRequest.useFilters===!0){var xhrArgs=arguments,defake=some(FakeXMLHttpRequest.filters,function(filter){return filter.apply(this,xhrArgs)});if(defake)return sinon.FakeXMLHttpRequest.defake(this,arguments)}this.readyStateChange(FakeXMLHttpRequest.OPENED)},readyStateChange:function(state){if(this.readyState=state,"function"==typeof this.onreadystatechange)try{this.onreadystatechange()}catch(e){sinon.logError("Fake XHR onreadystatechange handler",e)}this.dispatchEvent(new sinon.Event("readystatechange"))},setRequestHeader:function(header,value){if(verifyState(this),unsafeHeaders[header]||/^(Sec-|Proxy-)/.test(header))throw new Error('Refused to set unsafe header "'+header+'"');this.requestHeaders[header]?this.requestHeaders[header]+=","+value:this.requestHeaders[header]=value},setResponseHeaders:function(headers){this.responseHeaders={};for(var header in headers)headers.hasOwnProperty(header)&&(this.responseHeaders[header]=headers[header]);this.async?this.readyStateChange(FakeXMLHttpRequest.HEADERS_RECEIVED):this.readyState=FakeXMLHttpRequest.HEADERS_RECEIVED},send:function(data){if(verifyState(this),!/^(get|head)$/i.test(this.method)){if(this.requestHeaders["Content-Type"]){var value=this.requestHeaders["Content-Type"].split(";");this.requestHeaders["Content-Type"]=value[0]+";charset=utf-8"}else this.requestHeaders["Content-Type"]="text/plain;charset=utf-8";this.requestBody=data}this.errorFlag=!1,this.sendFlag=this.async,this.readyStateChange(FakeXMLHttpRequest.OPENED),"function"==typeof this.onSend&&this.onSend(this)},abort:function(){this.aborted=!0,this.responseText=null,this.errorFlag=!0,this.requestHeaders={},this.readyState>sinon.FakeXMLHttpRequest.UNSENT&&this.sendFlag&&(this.readyStateChange(sinon.FakeXMLHttpRequest.DONE),this.sendFlag=!1),this.readyState=sinon.FakeXMLHttpRequest.UNSENT},getResponseHeader:function(header){if(this.readyState<FakeXMLHttpRequest.HEADERS_RECEIVED)return null;if(/^Set-Cookie2?$/i.test(header))return null;header=header.toLowerCase();for(var h in this.responseHeaders)if(h.toLowerCase()==header)return this.responseHeaders[h];return null},getAllResponseHeaders:function(){if(this.readyState<FakeXMLHttpRequest.HEADERS_RECEIVED)return"";var headers="";for(var header in this.responseHeaders)this.responseHeaders.hasOwnProperty(header)&&!/^Set-Cookie2?$/i.test(header)&&(headers+=header+": "+this.responseHeaders[header]+"\r\n");return headers},setResponseBody:function(body){verifyRequestSent(this),verifyHeadersReceived(this),verifyResponseBodyType(body);var chunkSize=this.chunkSize||10,index=0;this.responseText="";do this.async&&this.readyStateChange(FakeXMLHttpRequest.LOADING),this.responseText+=body.substring(index,index+chunkSize),index+=chunkSize;while(index<body.length);var type=this.getResponseHeader("Content-Type");if(this.responseText&&(!type||/(text\/xml)|(application\/xml)|(\+xml)/.test(type)))try{this.responseXML=FakeXMLHttpRequest.parseXML(this.responseText)}catch(e){}this.async?this.readyStateChange(FakeXMLHttpRequest.DONE):this.readyState=FakeXMLHttpRequest.DONE},respond:function(status,headers,body){this.setResponseHeaders(headers||{}),this.status="number"==typeof status?status:200,this.statusText=FakeXMLHttpRequest.statusCodes[this.status],this.setResponseBody(body||"")}}),sinon.extend(FakeXMLHttpRequest,{UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4}),FakeXMLHttpRequest.parseXML=function(text){var xmlDoc;if("undefined"!=typeof DOMParser){var parser=new DOMParser;xmlDoc=parser.parseFromString(text,"text/xml")}else xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.async="false",xmlDoc.loadXML(text);return xmlDoc},FakeXMLHttpRequest.statusCodes={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choice",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"},sinon.useFakeXMLHttpRequest=function(){return sinon.FakeXMLHttpRequest.restore=function(keepOnCreate){xhr.supportsXHR&&(global.XMLHttpRequest=xhr.GlobalXMLHttpRequest),xhr.supportsActiveX&&(global.ActiveXObject=xhr.GlobalActiveXObject),delete sinon.FakeXMLHttpRequest.restore,keepOnCreate!==!0&&delete sinon.FakeXMLHttpRequest.onCreate},xhr.supportsXHR&&(global.XMLHttpRequest=sinon.FakeXMLHttpRequest),xhr.supportsActiveX&&(global.ActiveXObject=function(objId){return"Microsoft.XMLHTTP"==objId||/^Msxml2\.XMLHTTP/i.test(objId)?new sinon.FakeXMLHttpRequest:new xhr.GlobalActiveXObject(objId)}),sinon.FakeXMLHttpRequest},sinon.FakeXMLHttpRequest=FakeXMLHttpRequest}(this),"object"==typeof module&&"function"==typeof require&&(module.exports=sinon),"undefined"==typeof sinon)var sinon={};if(sinon.fakeServer=function(){function F(){}function create(proto){return F.prototype=proto,new F}function responseArray(handler){var response=handler;if("[object Array]"!=Object.prototype.toString.call(handler)&&(response=[200,{},handler]),"string"!=typeof response[2])throw new TypeError("Fake server response body should be string, but was "+typeof response[2]);return response}function matchOne(response,reqMethod,reqUrl){var rmeth=response.method,matchMethod=!rmeth||rmeth.toLowerCase()==reqMethod.toLowerCase(),url=response.url,matchUrl=!url||url==reqUrl||"function"==typeof url.test&&url.test(reqUrl);return matchMethod&&matchUrl}function match(response,request){var requestUrl=(this.getHTTPMethod(request),request.url);if((!/^https?:\/\//.test(requestUrl)||rCurrLoc.test(requestUrl))&&(requestUrl=requestUrl.replace(rCurrLoc,"")),matchOne(response,this.getHTTPMethod(request),requestUrl)){if("function"==typeof response.response){var ru=response.url,args=[request].concat(ru?requestUrl.match(ru).slice(1):[]);return response.response.apply(response,args)}return!0}return!1}function log(response,request){var str;str="Request:\n"+sinon.format(request)+"\n\n",str+="Response:\n"+sinon.format(response)+"\n\n",sinon.log(str)}var push=[].push,wloc="undefined"!=typeof window?window.location:{},rCurrLoc=new RegExp("^"+wloc.protocol+"//"+wloc.host);return{create:function(){var server=create(this);return this.xhr=sinon.useFakeXMLHttpRequest(),server.requests=[],this.xhr.onCreate=function(xhrObj){server.addRequest(xhrObj)},server},addRequest:function(xhrObj){var server=this;push.call(this.requests,xhrObj),xhrObj.onSend=function(){server.handleRequest(this)},this.autoRespond&&!this.responding&&(setTimeout(function(){server.responding=!1,server.respond()},this.autoRespondAfter||10),this.responding=!0)},getHTTPMethod:function(request){if(this.fakeHTTPMethods&&/post/i.test(request.method)){var matches=(request.requestBody||"").match(/_method=([^\b;]+)/);return matches?matches[1]:request.method}return request.method},handleRequest:function(xhr){xhr.async?(this.queue||(this.queue=[]),push.call(this.queue,xhr)):this.processRequest(xhr)
},respondWith:function(method,url,body){return 1==arguments.length&&"function"!=typeof method?void(this.response=responseArray(method)):(this.responses||(this.responses=[]),1==arguments.length&&(body=method,url=method=null),2==arguments.length&&(body=url,url=method,method=null),void push.call(this.responses,{method:method,url:url,response:"function"==typeof body?body:responseArray(body)}))},respond:function(){arguments.length>0&&this.respondWith.apply(this,arguments);for(var request,queue=this.queue||[];request=queue.shift();)this.processRequest(request)},processRequest:function(request){try{if(request.aborted)return;var response=this.response||[404,{},""];if(this.responses)for(var i=0,l=this.responses.length;l>i;i++)if(match.call(this,this.responses[i],request)){response=this.responses[i].response;break}4!=request.readyState&&(log(response,request),request.respond(response[0],response[1],response[2]))}catch(e){sinon.logError("Fake server request processing",e)}},restore:function(){return this.xhr.restore&&this.xhr.restore.apply(this.xhr,arguments)}}}(),"object"==typeof module&&"function"==typeof require&&(module.exports=sinon),function(){function Server(){}Server.prototype=sinon.fakeServer,sinon.fakeServerWithClock=new Server,sinon.fakeServerWithClock.addRequest=function(xhr){if(xhr.async&&("object"==typeof setTimeout.clock?this.clock=setTimeout.clock:(this.clock=sinon.useFakeTimers(),this.resetClock=!0),!this.longestTimeout)){var clockSetTimeout=this.clock.setTimeout,clockSetInterval=this.clock.setInterval,server=this;this.clock.setTimeout=function(fn,timeout){return server.longestTimeout=Math.max(timeout,server.longestTimeout||0),clockSetTimeout.apply(this,arguments)},this.clock.setInterval=function(fn,timeout){return server.longestTimeout=Math.max(timeout,server.longestTimeout||0),clockSetInterval.apply(this,arguments)}}return sinon.fakeServer.addRequest.call(this,xhr)},sinon.fakeServerWithClock.respond=function(){var returnVal=sinon.fakeServer.respond.apply(this,arguments);return this.clock&&(this.clock.tick(this.longestTimeout||0),this.longestTimeout=0,this.resetClock&&(this.clock.restore(),this.resetClock=!1)),returnVal},sinon.fakeServerWithClock.restore=function(){return this.clock&&this.clock.restore(),sinon.fakeServer.restore.apply(this,arguments)}}(),"object"==typeof module&&"function"==typeof require){var sinon=require("../sinon");sinon.extend(sinon,require("./util/fake_timers"))}return function(){function exposeValue(sandbox,config,key,value){value&&(config.injectInto?config.injectInto[key]=value:push.call(sandbox.args,value))}function prepareSandboxFromConfig(config){var sandbox=sinon.create(sinon.sandbox);return config.useFakeServer&&("object"==typeof config.useFakeServer&&(sandbox.serverPrototype=config.useFakeServer),sandbox.useFakeServer()),config.useFakeTimers&&("object"==typeof config.useFakeTimers?sandbox.useFakeTimers.apply(sandbox,config.useFakeTimers):sandbox.useFakeTimers()),sandbox}var push=[].push;sinon.sandbox=sinon.extend(sinon.create(sinon.collection),{useFakeTimers:function(){return this.clock=sinon.useFakeTimers.apply(sinon,arguments),this.add(this.clock)},serverPrototype:sinon.fakeServer,useFakeServer:function(){var proto=this.serverPrototype||sinon.fakeServer;return proto&&proto.create?(this.server=proto.create(),this.add(this.server)):null},inject:function(obj){return sinon.collection.inject.call(this,obj),this.clock&&(obj.clock=this.clock),this.server&&(obj.server=this.server,obj.requests=this.server.requests),obj},create:function(config){if(!config)return sinon.create(sinon.sandbox);var sandbox=prepareSandboxFromConfig(config);sandbox.args=sandbox.args||[];var prop,value,exposed=sandbox.inject({});if(config.properties)for(var i=0,l=config.properties.length;l>i;i++)prop=config.properties[i],value=exposed[prop]||"sandbox"==prop&&sandbox,exposeValue(sandbox,config,prop,value);else exposeValue(sandbox,config,"sandbox",value);return sandbox}}),sinon.sandbox.useFakeXMLHttpRequest=sinon.sandbox.useFakeServer,"object"==typeof module&&"function"==typeof require&&(module.exports=sinon.sandbox)}(),function(sinon){function test(callback){var type=typeof callback;if("function"!=type)throw new TypeError("sinon.test needs to wrap a test function, got "+type);return function(){var config=sinon.getConfig(sinon.config);config.injectInto=config.injectIntoThis&&this||config.injectInto;var exception,result,sandbox=sinon.sandbox.create(config),args=Array.prototype.slice.call(arguments).concat(sandbox.args);try{result=callback.apply(this,args)}catch(e){exception=e}if("undefined"!=typeof exception)throw sandbox.restore(),exception;return sandbox.verifyAndRestore(),result}}var commonJSModule="object"==typeof module&&"function"==typeof require;!sinon&&commonJSModule&&(sinon=require("../sinon")),sinon&&(test.config={injectIntoThis:!0,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:!0,useFakeServer:!0},commonJSModule?module.exports=test:sinon.test=test)}("object"==typeof sinon&&sinon||null),function(sinon){function createTest(property,setUp,tearDown){return function(){setUp&&setUp.apply(this,arguments);var exception,result;try{result=property.apply(this,arguments)}catch(e){exception=e}if(tearDown&&tearDown.apply(this,arguments),exception)throw exception;return result}}function testCase(tests,prefix){if(!tests||"object"!=typeof tests)throw new TypeError("sinon.testCase needs an object with test functions");prefix=prefix||"test";var testName,property,method,rPrefix=new RegExp("^"+prefix),methods={},setUp=tests.setUp,tearDown=tests.tearDown;for(testName in tests)if(tests.hasOwnProperty(testName)){if(property=tests[testName],/^(setUp|tearDown)$/.test(testName))continue;"function"==typeof property&&rPrefix.test(testName)?(method=property,(setUp||tearDown)&&(method=createTest(property,setUp,tearDown)),methods[testName]=sinon.test(method)):methods[testName]=tests[testName]}return methods}var commonJSModule="object"==typeof module&&"function"==typeof require;!sinon&&commonJSModule&&(sinon=require("../sinon")),sinon&&Object.prototype.hasOwnProperty&&(commonJSModule?module.exports=testCase:sinon.testCase=testCase)}("object"==typeof sinon&&sinon||null),function(sinon,global){function verifyIsStub(){for(var method,i=0,l=arguments.length;l>i;++i)method=arguments[i],method||assert.fail("fake is not a spy"),"function"!=typeof method&&assert.fail(method+" is not a function"),"function"!=typeof method.getCall&&assert.fail(method+" is not stubbed")}function failAssertion(object,msg){object=object||global;var failMethod=object.fail||assert.fail;failMethod.call(object,msg)}function mirrorPropAsAssertion(name,method,message){2==arguments.length&&(message=method,method=name),assert[name]=function(fake){verifyIsStub(fake);var args=slice.call(arguments,1),failed=!1;failed="function"==typeof method?!method(fake):"function"==typeof fake[method]?!fake[method].apply(fake,args):!fake[method],failed?failAssertion(this,fake.printf.apply(fake,[message].concat(args))):assert.pass(name)}}function exposedName(prefix,prop){return!prefix||/^fail/.test(prop)?prop:prefix+prop.slice(0,1).toUpperCase()+prop.slice(1)}var assert,commonJSModule="object"==typeof module&&"function"==typeof require,slice=Array.prototype.slice;!sinon&&commonJSModule&&(sinon=require("../sinon")),sinon&&(assert={failException:"AssertError",fail:function(message){var error=new Error(message);throw error.name=this.failException||assert.failException,error},pass:function(){},callOrder:function(){verifyIsStub.apply(null,arguments);var expected="",actual="";if(sinon.calledInOrder(arguments))assert.pass("callOrder");else{try{expected=[].join.call(arguments,", "),actual=sinon.orderByFirstCall(slice.call(arguments)).join(", ")}catch(e){}failAssertion(this,"expected "+expected+" to be called in order but were called as "+actual)}},callCount:function(method,count){if(verifyIsStub(method),method.callCount!=count){var msg="expected %n to be called "+sinon.timesInWords(count)+" but was called %c%C";failAssertion(this,method.printf(msg))}else assert.pass("callCount")},expose:function(target,options){if(!target)throw new TypeError("target is null or undefined");var o=options||{},prefix="undefined"==typeof o.prefix&&"assert"||o.prefix,includeFail="undefined"==typeof o.includeFail||!!o.includeFail;for(var method in this)"export"==method||!includeFail&&/^(fail)/.test(method)||(target[exposedName(prefix,method)]=this[method]);return target}},mirrorPropAsAssertion("called","expected %n to have been called at least once but was never called"),mirrorPropAsAssertion("notCalled",function(spy){return!spy.called},"expected %n to not have been called but was called %c%C"),mirrorPropAsAssertion("calledOnce","expected %n to be called once but was called %c%C"),mirrorPropAsAssertion("calledTwice","expected %n to be called twice but was called %c%C"),mirrorPropAsAssertion("calledThrice","expected %n to be called thrice but was called %c%C"),mirrorPropAsAssertion("calledOn","expected %n to be called with %1 as this but was called with %t"),mirrorPropAsAssertion("alwaysCalledOn","expected %n to always be called with %1 as this but was called with %t"),mirrorPropAsAssertion("calledWithNew","expected %n to be called with new"),mirrorPropAsAssertion("alwaysCalledWithNew","expected %n to always be called with new"),mirrorPropAsAssertion("calledWith","expected %n to be called with arguments %*%C"),mirrorPropAsAssertion("calledWithMatch","expected %n to be called with match %*%C"),mirrorPropAsAssertion("alwaysCalledWith","expected %n to always be called with arguments %*%C"),mirrorPropAsAssertion("alwaysCalledWithMatch","expected %n to always be called with match %*%C"),mirrorPropAsAssertion("calledWithExactly","expected %n to be called with exact arguments %*%C"),mirrorPropAsAssertion("alwaysCalledWithExactly","expected %n to always be called with exact arguments %*%C"),mirrorPropAsAssertion("neverCalledWith","expected %n to never be called with arguments %*%C"),mirrorPropAsAssertion("neverCalledWithMatch","expected %n to never be called with match %*%C"),mirrorPropAsAssertion("threw","%n did not throw exception%C"),mirrorPropAsAssertion("alwaysThrew","%n did not always throw exception%C"),commonJSModule?module.exports=assert:sinon.assert=assert)}("object"==typeof sinon&&sinon||null,"undefined"!=typeof window?window:global),sinon}.call("undefined"!=typeof window&&window||{});!function(sinonChai){"use strict";"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?module.exports=sinonChai:"function"==typeof define&&define.amd?define(function(){return sinonChai}):chai.use(sinonChai)}(function(chai,utils){"use strict";function isSpy(putativeSpy){return"function"==typeof putativeSpy&&"function"==typeof putativeSpy.getCall&&"function"==typeof putativeSpy.calledWithExactly}function isCall(putativeCall){return putativeCall&&isSpy(putativeCall.proxy)}function assertCanWorkWith(assertion){if(!isSpy(assertion._obj)&&!isCall(assertion._obj))throw new TypeError(utils.inspect(assertion._obj)+" is not a spy or a call to a spy!")}function getMessages(spy,action,nonNegatedSuffix,always,args){function printfArray(array){return spy.printf.apply(spy,array)}var verbPhrase=always?"always have ":"have ";return nonNegatedSuffix=nonNegatedSuffix||"",isSpy(spy.proxy)&&(spy=spy.proxy),{affirmative:printfArray(["expected %n to "+verbPhrase+action+nonNegatedSuffix].concat(args)),negative:printfArray(["expected %n to not "+verbPhrase+action].concat(args))}}function sinonProperty(name,action,nonNegatedSuffix){utils.addProperty(chai.Assertion.prototype,name,function(){assertCanWorkWith(this);var messages=getMessages(this._obj,action,nonNegatedSuffix,!1);this.assert(this._obj[name],messages.affirmative,messages.negative)})}function createSinonMethodHandler(sinonName,action,nonNegatedSuffix){return function(){assertCanWorkWith(this);var alwaysSinonMethod="always"+sinonName[0].toUpperCase()+sinonName.substring(1),shouldBeAlways=utils.flag(this,"always")&&"function"==typeof this._obj[alwaysSinonMethod],sinonMethod=shouldBeAlways?alwaysSinonMethod:sinonName,messages=getMessages(this._obj,action,nonNegatedSuffix,shouldBeAlways,slice.call(arguments));this.assert(this._obj[sinonMethod].apply(this._obj,arguments),messages.affirmative,messages.negative)}}function sinonMethodAsProperty(name,action,nonNegatedSuffix){var handler=createSinonMethodHandler(name,action,nonNegatedSuffix);utils.addProperty(chai.Assertion.prototype,name,handler)}function exceptionalSinonMethod(chaiName,sinonName,action,nonNegatedSuffix){var handler=createSinonMethodHandler(sinonName,action,nonNegatedSuffix);utils.addMethod(chai.Assertion.prototype,chaiName,handler)}function sinonMethod(name,action,nonNegatedSuffix){exceptionalSinonMethod(name,name,action,nonNegatedSuffix)}var slice=Array.prototype.slice;utils.addProperty(chai.Assertion.prototype,"always",function(){utils.flag(this,"always",!0)}),sinonProperty("called","been called"," at least once, but it was never called"),sinonProperty("calledOnce","been called exactly once",", but it was called %c%C"),sinonProperty("calledTwice","been called exactly twice",", but it was called %c%C"),sinonProperty("calledThrice","been called exactly thrice",", but it was called %c%C"),sinonMethodAsProperty("calledWithNew","been called with new"),sinonMethod("calledBefore","been called before %1"),sinonMethod("calledAfter","been called after %1"),sinonMethod("calledOn","been called with %1 as this",", but it was called with %t instead"),sinonMethod("calledWith","been called with arguments %*","%C"),sinonMethod("calledWithExactly","been called with exact arguments %*","%C"),sinonMethod("calledWithMatch","been called with arguments matching %*","%C"),sinonMethod("returned","returned %1"),exceptionalSinonMethod("thrown","threw","thrown %1")}),mocha.setup({ui:"bdd"}),window.expect=chai.expect;